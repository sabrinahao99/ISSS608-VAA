<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zhiyi Hao">
<meta name="dcterms.date" content="2026-02-05">

<title>Take-home Exercise 1final – ISSS608-VAA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3c103c788aac4b067399430f7745d67d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05b/Hands-on_Ex05b.html">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01final/Take-home_Ex01final.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1.Overview</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">1.1 Background</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">1.2 The Data</a></li>
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">1.3 The Task</a></li>
  </ul></li>
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages">2.Loading Packages</a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">3.Data Import</a>
  <ul class="collapse">
  <li><a href="#importing-.xlsx-file" id="toc-importing-.xlsx-file" class="nav-link" data-scroll-target="#importing-.xlsx-file">3.1 Importing .xlsx file</a></li>
  <li><a href="#duplicates-check" id="toc-duplicates-check" class="nav-link" data-scroll-target="#duplicates-check">3.2 Duplicates Check</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">4.Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#variable-selection" id="toc-variable-selection" class="nav-link" data-scroll-target="#variable-selection">4.1 Variable Selection</a></li>
  <li><a href="#final-checks-for-dataset-quality" id="toc-final-checks-for-dataset-quality" class="nav-link" data-scroll-target="#final-checks-for-dataset-quality">4.2 Final checks for dataset quality</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">5.0 Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#academic-performance-and-demographic-characteristics" id="toc-academic-performance-and-demographic-characteristics" class="nav-link" data-scroll-target="#academic-performance-and-demographic-characteristics">5 Academic Performance and Demographic Characteristics</a>
  <ul class="collapse">
  <li><a href="#viz1-academic-performance-exhibits-high-median-stability-but-increasing-divergence-in-later-study-years" id="toc-viz1-academic-performance-exhibits-high-median-stability-but-increasing-divergence-in-later-study-years" class="nav-link" data-scroll-target="#viz1-academic-performance-exhibits-high-median-stability-but-increasing-divergence-in-later-study-years">Viz1: Academic performance exhibits high median stability but increasing divergence in later study years</a></li>
  <li><a href="#viz2-higher-parental-education-significantly-boosts-the-probability-of-achieving-a-high-gpa" id="toc-viz2-higher-parental-education-significantly-boosts-the-probability-of-achieving-a-high-gpa" class="nav-link" data-scroll-target="#viz2-higher-parental-education-significantly-boosts-the-probability-of-achieving-a-high-gpa">Viz2: Higher parental education significantly boosts the probability of achieving a high GPA</a></li>
  <li><a href="#viz3-mothers-education-shows-a-more-consistent-impact-on-student-gpa" id="toc-viz3-mothers-education-shows-a-more-consistent-impact-on-student-gpa" class="nav-link" data-scroll-target="#viz3-mothers-education-shows-a-more-consistent-impact-on-student-gpa">Viz3: Mother’s education shows a more consistent impact on student GPA</a></li>
  <li><a href="#viz4-high-gpa-students-spent-more-time-on-study-while-spent-less-on-social-media" id="toc-viz4-high-gpa-students-spent-more-time-on-study-while-spent-less-on-social-media" class="nav-link" data-scroll-target="#viz4-high-gpa-students-spent-more-time-on-study-while-spent-less-on-social-media">Viz4: High GPA students spent more time on study while spent less on social media</a>
  <ul class="collapse">
  <li><a href="#viz5-does-high-gpa-students-spent-less-time-on-social-media-and-more-on-study" id="toc-viz5-does-high-gpa-students-spent-less-time-on-social-media-and-more-on-study" class="nav-link" data-scroll-target="#viz5-does-high-gpa-students-spent-less-time-on-social-media-and-more-on-study">Viz5: Does high GPA students spent less time on social media and more on study?</a></li>
  </ul></li>
  <li><a href="#student-perceptions-and-learning-environment" id="toc-student-perceptions-and-learning-environment" class="nav-link" data-scroll-target="#student-perceptions-and-learning-environment">6 Student Perceptions and Learning Environment</a>
  <ul class="collapse">
  <li><a href="#viz6-students-are-most-satisfied-with-school-but-personal-habits-still-decides-at-certain-cases" id="toc-viz6-students-are-most-satisfied-with-school-but-personal-habits-still-decides-at-certain-cases" class="nav-link" data-scroll-target="#viz6-students-are-most-satisfied-with-school-but-personal-habits-still-decides-at-certain-cases">Viz6: Students are most satisfied with school but personal habits still decides at certain cases</a></li>
  <li><a href="#viz7-does-gpa-have-the-relationship-with-perception-variables" id="toc-viz7-does-gpa-have-the-relationship-with-perception-variables" class="nav-link" data-scroll-target="#viz7-does-gpa-have-the-relationship-with-perception-variables">Viz7: Does GPA have the relationship with perception variables?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">7. Summary</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">8.References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Take-home Exercise 1final</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Zhiyi Hao </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 5, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level1">
<h1>1.Overview</h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">1.1 Background</h2>
<p>Nowadays, researchers have long been dedicated to researching the factors influencing student academic performance. The dataset used in this analysis comes from VNU University of Education and aims to comprehensively explore the deep relationship between various real-world factors and student academic achievement (GPA).</p>
<p>The survey was conducted from March to June 2023, collecting 2,170 responses from students. The data primarily covers two core dimensions: 1) students’ demographic characteristics and lifestyle habits (e.g., Academic Year, parental educational background, allocation of their time); 2) students’ learning perceptions at university(e.g., feelings of teaching quality, facilities, influence from friends etc.).</p>
<p>Through exploratory data analysis (EDA) of these different types of data, we hope to identify the key indicators may affectiing students’ GPA and find relationships. This will not only provide school administrators with objective feedback but also help teachers and academic advisors better understand the factors influencing student performance, and also enabling them to take measures if needed to improve overall teaching effectiveness.</p>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">1.2 The Data</h2>
<p>The data for this exercise is the Student questionnaire data(database paper) file in .xlsx format, retrieved from <a href="https://data.mendeley.com/datasets/23ppcdbmhc/1">Mendeley Data Repository</a>. <img src="image1.png" class="img-fluid"></p>
<p>Supplementary materials used in conjunction with dataset:</p>
<ul>
<li><a href="https://data.mendeley.com/datasets/23ppcdbmhc/1">Codebook</a></li>
</ul>
</section>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">1.3 The Task</h2>
<p>Based on the 2023 VNU Student Questionnaire Dataset, this post aims to reveal followings by using appropriate <strong>Exploratory Data Analysis (EDA) methods</strong> and <strong>the ggplot2 package</strong></p>
<ul>
<li><p>the distribution of academic performance (GPA)across different year students at Vietnam National University</p></li>
<li><p>the relationships between these academic performances and family socioeconomic status (parental education level), personal behavioral habits (time spent studying and social media), and perception varaibles.</p></li>
</ul>
</section>
</section>
<section id="loading-packages" class="level1">
<h1>2.Loading Packages</h1>
<p>In this exercise, several R packages will be used. They are listed in the table below:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Library</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a></td>
<td style="text-align: left;">A collection of core packages used for data preparation and wrangling.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://yihui.org/knitr/"><strong>knitr</strong></a></td>
<td style="text-align: left;">For dynamic report generation.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://patchwork.data-imaginist.com/"><strong>patchwork</strong></a></td>
<td style="text-align: left;">For preparing composite figure created using ggplot2.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://wilkelab.org/ggridges/"><strong>ggridges</strong></a></td>
<td style="text-align: left;">For ridgeline plots that create the impression of a mountain range.can be useful for visualising changes in distributions over time.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://mjskay.github.io/ggdist/"><strong>ggdist</strong></a></td>
<td style="text-align: left;">For visualisations of distributions and uncertainty. Key package for creating Raincloud Plots.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://cran.r-project.org/web/packages/HH/HH.pdf"><strong>HH</strong></a></td>
<td style="text-align: left;">particularly known for its likert() function which creates diverging stacked bar charts for Likert scale dataspecialized.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://cloud.r-project.org/web/packages/ggtern/ggtern.pdf"><strong>ggtern</strong></a></td>
<td style="text-align: left;">a ggplot extension specially designed to plot ternary diagrams. The package will be used to plot static ternary plots.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://indrajeetpatil.github.io/ggstatsplot/"><strong>ggstatsplot</strong></a></td>
<td style="text-align: left;">{ggstatsplot} is an extension of {ggplot2} package for creating graphics with details from statistical tests included in the information-rich plots themselves.</td>
</tr>
</tbody>
</table>
<p>The following code chunk uses <code>p_load()</code> of <a href="https://rpubs.com/akshaypatankar/594834"><strong>pacman</strong></a> package to check if tidyverse packages are installed in the computer. If they are, the libraries will be called into R.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  tidyverse,    </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  knitr,       </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  patchwork,    </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  ggridges,     </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  ggtern,      </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  HH,           </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ggstatsplot   </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="data-import" class="level1">
<h1>3.Data Import</h1>
<p>In sections 3 and 4, I will explain all the steps of data processing — from reading the raw data to generating the final dataset. I will use the tidyverse package for data cleaning and readxl for reading the data.</p>
<section id="importing-.xlsx-file" class="level2">
<h2 class="anchored" data-anchor-id="importing-.xlsx-file">3.1 Importing .xlsx file</h2>
<p>The following code block uses the <code>read_excel()</code> function from the <code>readxl</code> package to import the original dataset. This data originates from the file <code>Database paper.xlsx</code>.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>raw_dataset <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/Database paper.xlsx"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>raw_dataset</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,170 × 22
    Year Gender Policy_Stu Minority_Stu Poor_Stu Father_Edu Mother_Edu
   &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1     5      2          2            2        2          4          4
 2     5      1          2            2        2          3          3
 3     5      2          2            2        2          4          4
 4     5      2          2            2        2          5          4
 5     5      1          1            2        2          2          3
 6     5      2          2            2        2          5          5
 7     5      2          2            2        2          6          5
 8     5      2          2            2        2          5          4
 9     5      2          2            2        2          5          5
10     5      2          2            2        2          5          4
# ℹ 2,160 more rows
# ℹ 15 more variables: Father_Occupation &lt;dbl&gt;, Mother_Occupation &lt;dbl&gt;,
#   Time_Friends &lt;dbl&gt;, Time_SocicalMedia &lt;dbl&gt;, Time_Studying &lt;dbl&gt;,
#   GPA &lt;dbl&gt;, Adapt_Learning_Uni &lt;dbl&gt;, Study_Methods &lt;dbl&gt;,
#   SupportOf_Uni &lt;dbl&gt;, SupportOf_Lec &lt;dbl&gt;, Facilitie_Uni &lt;dbl&gt;,
#   Quality_Lecturer &lt;dbl&gt;, TrainingCurriculum &lt;dbl&gt;, Competitive_Class &lt;dbl&gt;,
#   InfuenceF_Friends &lt;dbl&gt;</code></pre>
</div>
</div>
<p>This dataset contains 2,170 observations (rows) and 22 variables (columns). Each observation corresponds to a participating student or alumnus, and the variables cover students’ demographic characteristics, family background, and perceptions of the school environment.</p>
</section>
<section id="duplicates-check" class="level2">
<h2 class="anchored" data-anchor-id="duplicates-check">3.2 Duplicates Check</h2>
<p>To ensure data quality, we need to check there are duplicated records in the dataset.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(raw_dataset))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 226</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(raw_dataset)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2170</code></pre>
</div>
</div>
<p>We can find the duplicated record is 226 out of the raw data sample of 2170, however, there is no distinct record like ID in our dataset, we can’t treat all duplicated data as the true duplicated ones. Since repeated response patterns may represent the true frequency in the population, duplication based solely on identical values in the survey variables could distort the empirical distribution and introduce bias into subsequent analyses. Therefore, we retained all records.</p>
</section>
</section>
<section id="data-wrangling" class="level1">
<h1>4.Data Wrangling</h1>
<p>Since the raw_dataset contains a large number of numerical codes without labels, it is not suitable for direct analysis. Therefore, I strictly followed the official codebook and cleaned and standardized the data through the following steps.</p>
<section id="variable-selection" class="level2">
<h2 class="anchored" data-anchor-id="variable-selection">4.1 Variable Selection</h2>
<p>First, I select some useful variables required for EDA process and ensure the raw column names are consistently referenced. To ensure that the variables for subsequent visualization are cleaned, we should eliminate noise(drop useless variables). For the selection of direct variables, I chose to retain only those directly related to demographics, learning habits, and personal perceptions. In this step, I specifically excluded the following variables for the following reasons:</p>
<ul>
<li><p>Gender(A.2): To focus the analysis on universally applicable learning strategies and perceptual dimensions, gender was considered noise and therefore excluded.</p></li>
<li><p>Socioeconomic indicators (A.3, A.4, A.5): I excluded “policy support,” “minority status,” and “poverty status.” This analysis emphasizes individual student behaviors more than macro-level “socioeconomic background factors.”</p></li>
<li><p>Parental Occupation indicators (A.8, A.9): I selected “parents’ education level” and excluded “parents’ occupation.” In educational research, education level is generally considered a more stable and explanatory indicator of family cultural capital.</p></li>
</ul>
<p>Since most variables in the original dataset were numerical, I recoded them into meaningful and easily interpretable category labels according to the official coding manual. This step involved converting the raw data into ordinal factors (e.g., converting “1, 2, 3” into “none, moderate, very”), thus ensuring that subsequent visualizations and statistical tests were ordinal and valid.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>final_ggplot <span class="ot">&lt;-</span> raw_dataset</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Year_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Year, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"First-year"</span>, <span class="st">"Second-year"</span>, <span class="st">"Third-year"</span>, <span class="st">"Fourth-year"</span>, <span class="st">"Graduated"</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Father_Edu_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Father_Edu, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Primary"</span>, <span class="st">"Secondary"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"University/Grad"</span>, <span class="st">"Other"</span>))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Mother_Edu_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Mother_Edu, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Primary"</span>, <span class="st">"Secondary"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"University/Grad"</span>, <span class="st">"Other"</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Friends_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Time_Friends, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;1h"</span>, <span class="st">"1-2h"</span>, <span class="st">"2-3h"</span>, <span class="st">"3-4h"</span>, <span class="st">"&gt;=4h"</span>))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Social_Media_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Time_SocicalMedia, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;1h"</span>, <span class="st">"1-2h"</span>, <span class="st">"2-3h"</span>, <span class="st">"3-4h"</span>, <span class="st">"&gt;=4h"</span>))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Time_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Time_Studying, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;2h"</span>, <span class="st">"2-4h"</span>, <span class="st">"4-6h"</span>, <span class="st">"6-8h"</span>, <span class="st">"&gt;=8h"</span>))</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>GPA, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;2.0 (Poor)"</span>, <span class="st">"2.0–2.5 (Avg)"</span>, <span class="st">"2.5–3.2 (Fair)"</span>, <span class="st">"3.2–3.6 (Good)"</span>, <span class="st">"&gt;=3.6 (Excl)"</span>))</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>gpa_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.50</span>, <span class="fl">2.25</span>, <span class="fl">2.85</span>, <span class="fl">3.40</span>, <span class="fl">3.85</span>)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Num <span class="ot">&lt;-</span> gpa_map[<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(final_ggplot<span class="sc">$</span>GPA))]</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Adapt_Learning_Uni <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Adapt_Learning_Uni, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Methods      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Study_Methods, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>SupportOf_Uni      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>SupportOf_Uni, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>SupportOf_Lec      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>SupportOf_Lec, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Facilitie_Uni      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Facilitie_Uni, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Quality_Lecturer   <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Quality_Lecturer, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>TrainingCurriculum <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>TrainingCurriculum, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Competitive_Class  <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Competitive_Class, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>InfuenceF_Friends  <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>InfuenceF_Friends, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a><span class="co">#mapping GPA into numerical form GPA_Num</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Methods_Raw <span class="ot">&lt;-</span> raw_dataset<span class="sc">$</span>Study_Methods</span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Raw <span class="ot">&lt;-</span> raw_dataset<span class="sc">$</span>GPA</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>gpa_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.50</span>, <span class="fl">2.25</span>, <span class="fl">2.85</span>, <span class="fl">3.40</span>, <span class="fl">3.85</span>)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Num <span class="ot">&lt;-</span> gpa_map[<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(final_ggplot<span class="sc">$</span>GPA_Raw))]</span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Methods_Fix <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Study_Methods_Raw, </span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Note:Under is &lt;, Over is &gt;=, use symbols simplifies the final presentation.</p>
</section>
<section id="final-checks-for-dataset-quality" class="level2">
<h2 class="anchored" data-anchor-id="final-checks-for-dataset-quality">4.2 Final checks for dataset quality</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check if GPA_Num exists and missing value</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_ggplot<span class="sc">$</span>GPA_Num)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.500   2.850   2.850   2.999   3.400   3.850 </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(final_ggplot)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>The final checks confirmed that the dataset contained no missing values and no duplicate rows. Furthermore, all ordered variables were presented in the order of the official codebook.</p>
<p>After doing these two checks, we can make sure the data quality is good(no missing value, normal distribution,factor order is correct) and it is applicable for EDA process.</p>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1">
<h1>5.0 Exploratory Data Analysis (EDA)</h1>
<p>After data cleaning, we move on to the Exploratory Data Analysis (EDA). This chapter aims to use packages in R to create visualizations that reveal potential relationship in student demographics, behavioral habits, and academic performance.</p>
<p>This section has two parts, Group A and Group B, which coresponds to section 5 Academic Performance and Demographic Characteristics and 6 Student Perceptions and Learning Environment. Let’s start our analysis!</p>
</section>
<section id="academic-performance-and-demographic-characteristics" class="level1">
<h1>5 Academic Performance and Demographic Characteristics</h1>
<section id="viz1-academic-performance-exhibits-high-median-stability-but-increasing-divergence-in-later-study-years" class="level2">
<h2 class="anchored" data-anchor-id="viz1-academic-performance-exhibits-high-median-stability-but-increasing-divergence-in-later-study-years">Viz1: Academic performance exhibits high median stability but increasing divergence in later study years</h2>
<p>To explore the evolution of GPA distribution across different grade levels, I first cleaned the raw data. I mapped the categorical variable GPA to numerical midpoints (e.g., mapping grade 1 to 1.50 and grade 5 to 3.85), making GPA an analyzable numerical score for easy visualization. Next, I used the ggridges package to create a ridge plot to show the probability density distribution of grades across grade levels. Then, I used stat_density_ridges to automatically calculate quantiles. The extreme 2.5% regions at both ends of the distribution are highlighted in red and blue in the plot. This approach not only visually presents the central tendency of grades across grade levels but also effectively identifies the proportion of students with abnormally high or low GPAs.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#stats(quantile)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(final_ggplot, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GPA_Num, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Year_Label, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">stat</span>(quantile)))) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"density_ridges_gradient"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">calc_ecdf =</span> <span class="cn">TRUE</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Probability"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF0000A0"</span>, <span class="st">"#A0A0A0A0"</span>, <span class="st">"#0000FFA0"</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"(0, 0.025]"</span>, <span class="st">"(0.025, 0.975]"</span>, <span class="st">"(0.975, 1]"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Student GPA Scores by Academic Year"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Academic performance exhibits high median stability but increasing divergence in later study years"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"GPA Score (Mapping GPA category)"</span>,</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Academic Year"</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"plain"</span>),</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"plain"</span>),</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>😺 Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Overall, the GPA of students across all grades is around 3.0 (between Fair and Good), showing a significant peak. This indicates that the school’s students have very stable academic performance, with no extremely low scores, and the overall teaching quality is good.</p></li>
<li><p>As students progress through the years, they should be more adapted to university life, but the red zone on the left remains stable across all grades, especially in the third year. The reason for such a high proportion may need to be explored in terms of student perception or other aspects, such as their level of adaptation.</p></li>
<li><p>Towards graduation, the density of the blue zone on the right increases slightly, and the curve slopes more pronounced to the right. This may be because students nearing graduation have found a better study method, thus learning better and faster, resulting in a higher probability of having a high GPA.</p></li>
</ul>
</div>
</div></li>
</ul>
</section>
<section id="viz2-higher-parental-education-significantly-boosts-the-probability-of-achieving-a-high-gpa" class="level2">
<h2 class="anchored" data-anchor-id="viz2-higher-parental-education-significantly-boosts-the-probability-of-achieving-a-high-gpa">Viz2: Higher parental education significantly boosts the probability of achieving a high GPA</h2>
<p>I first defined a high GPA (same as year). A student’s GPA was recorded as TRUE if it was in the range of “3.2-3.6 (Good)” or “≥3.6 (Excellent),” and as FALSE otherwise. This binary variable fairly compares the relationship between parental education level and GPA. Next, I summarized the data by Father_Edu_Label and Mother_Edu_Label, calculating the sample size and high GPA rate for each group. Then, to determine the baseline for the funnel plot, I calculated a weighted average of these rates with a weight of <span class="math inline">\(1/se^2\)</span> to ensure that groups with larger sample sizes and more stable estimates have a greater impact on the overall mean. Next, I generated 95% (dashed line) and 99.9% (solid line) confidence intervals to define the expected range of variation. Finally, I constructed the funnel plot using ggplot2, applied geom_text to add labels for each education group, and ensured readability by managing label overlap.</p>
<p>Father’s education background</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute high GPA rate</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>high_gpa <span class="ot">&lt;-</span> final_ggplot<span class="sc">$</span>GPA_Label <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3.2–3.6 (Good)"</span>, <span class="st">"&gt;=3.6 (Excl)"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>n_tab <span class="ot">&lt;-</span> <span class="fu">table</span>(final_ggplot<span class="sc">$</span>Father_Edu_Label)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>rate_tab <span class="ot">&lt;-</span> <span class="fu">tapply</span>(high_gpa, final_ggplot<span class="sc">$</span>Father_Edu_Label, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">names</span>(n_tab),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positive =</span> <span class="fu">as.numeric</span>(n_tab),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">as.numeric</span>(rate_tab)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude the small size group</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>Positive <span class="sc">&gt;=</span> <span class="dv">5</span>, ]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rate.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((df<span class="sc">$</span>rate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>rate)) <span class="sc">/</span> df<span class="sc">$</span>Positive)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#compute fit.mean</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>fit.mean <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(df<span class="sc">$</span>rate, <span class="dv">1</span> <span class="sc">/</span> df<span class="sc">$</span>rate.se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate lower and upper limits for 95% and 99.9% CI</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>number.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(df<span class="sc">$</span>Positive), <span class="dv">1</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>number.ll95  <span class="ot">&lt;-</span> fit.mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>number.ul95  <span class="ot">&lt;-</span> fit.mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>number.ll999 <span class="ot">&lt;-</span> fit.mean <span class="sc">-</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>number.ul999 <span class="ot">&lt;-</span> fit.mean <span class="sc">+</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>dfCI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(number.ll95, number.ul95, number.ll999, number.ul999, number.seq, fit.mean)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Positive, <span class="at">y =</span> rate)) <span class="sc">+</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Group), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll95), </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul95), </span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll999), </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul999), </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">yintercept =</span> fit.mean), </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> <span class="st">"99.9%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"High GPA Rate by Father's Educational Background"</span>) <span class="sc">+</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span> </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"High GPA Rate (&gt;= 3.2)"</span>) <span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Mother’s education background</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>high_gpa <span class="ot">&lt;-</span> final_ggplot<span class="sc">$</span>GPA_Label <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3.2–3.6 (Good)"</span>, <span class="st">"&gt;=3.6 (Excl)"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>n_tab_m <span class="ot">&lt;-</span> <span class="fu">table</span>(final_ggplot<span class="sc">$</span>Mother_Edu_Label)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>rate_tab_m <span class="ot">&lt;-</span> <span class="fu">tapply</span>(high_gpa, final_ggplot<span class="sc">$</span>Mother_Edu_Label, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>df_m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">names</span>(n_tab_m),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positive =</span> <span class="fu">as.numeric</span>(n_tab_m),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">as.numeric</span>(rate_tab_m)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>df_m <span class="ot">&lt;-</span> df_m[df_m<span class="sc">$</span>Positive <span class="sc">&gt;=</span> <span class="dv">5</span>, ]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>df_m<span class="sc">$</span>rate.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((df_m<span class="sc">$</span>rate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> df_m<span class="sc">$</span>rate)) <span class="sc">/</span> df_m<span class="sc">$</span>Positive)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co">#compute fit.mean</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>fit.mean_m <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(df_m<span class="sc">$</span>rate, <span class="dv">1</span> <span class="sc">/</span> df_m<span class="sc">$</span>rate.se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate lower and upper limits for 95% and 99.9% CI</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>number.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(df_m<span class="sc">$</span>Positive), <span class="dv">1</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>number.ll95  <span class="ot">&lt;-</span> fit.mean_m <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>number.ul95  <span class="ot">&lt;-</span> fit.mean_m <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>number.ll999 <span class="ot">&lt;-</span> fit.mean_m <span class="sc">-</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>number.ul999 <span class="ot">&lt;-</span> fit.mean_m <span class="sc">+</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>dfCI_m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(number.ll95, number.ul95, number.ll999, number.ul999, number.seq, fit.mean_m)</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_m, <span class="fu">aes</span>(<span class="at">x =</span> Positive, <span class="at">y =</span> rate)) <span class="sc">+</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Group), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll95), </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul95), </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll999), </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul999), </span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">yintercept =</span> fit.mean_m), </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df_m<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean_m <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df_m<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean_m <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> <span class="st">"99.9%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"High GPA Rate by Mother's Educational Background"</span>) <span class="sc">+</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size (n)"</span>) <span class="sc">+</span> </span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"High GPA Rate (&gt;= 3.2)"</span>) <span class="sc">+</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>p2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>😺 Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Both graphs show that the points for the University/Graduate education group are generally higher, while those for Primary School/Secondary School are lower. This suggests strongly a positive correlation between parental education level and the probability of their child achieving a high GPA.</p></li>
<li><p>Furthermore, most points fall within the 95%/99% threshold, indicating no significant differences within the sample size and normal levels compared to the overall average.</p></li>
<li><p>From an overall perspective, therefore, we can conclude that while there is a trend where higher parental education levels generally correlate with higher GPA rates.</p></li>
</ul>
</div>
</div></li>
</ul>
</section>
<section id="viz3-mothers-education-shows-a-more-consistent-impact-on-student-gpa" class="level2">
<h2 class="anchored" data-anchor-id="viz3-mothers-education-shows-a-more-consistent-impact-on-student-gpa">Viz3: Mother’s education shows a more consistent impact on student GPA</h2>
<p>First, we need to process the fields – defining High GPA. This requires converting the original GPA_Cat into a binary variable, where high rate means: when a student’s GPA falls within “3.2–&lt;3.6 (Good)” or “≥3.6 (Excellent),” it is recorded as TRUE; otherwise, it is FALSE. This can be used to compare the high GPA performance of different groups. Next, we group by parent’s education level and calculate the High GPA rate. First, we group separately for Father_Edu / Mother_Edu, calculating n (sample size) and rate. Then, we calculate the overall mean, using weights of 1 / rate.se^2 to give higher weights to groups with larger sample sizes and more stable estimates. Then, we generate the 95% / 99% confidence limits for the funnel. Finally, we use the above output to generate the plot. In addition to <strong>ggplot</strong>, <strong>ggrepel</strong> is also used to prevent overlap.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>p_fa_tail <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(final_ggplot, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> GPA_Num, <span class="at">y =</span> Father_Edu_Label, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">stat</span>(ecdf)))) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">geom =</span> <span class="st">"density_ridges_gradient"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">calc_ecdf =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Tail Prob."</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> <span class="st">"mako"</span>) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Father's Education"</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"GPA Score"</span>, <span class="at">y =</span> <span class="st">"Education Level"</span>) <span class="sc">+</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>p_mo_tail <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(final_ggplot, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> GPA_Num, <span class="at">y =</span> Mother_Edu_Label, </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">stat</span>(ecdf)))) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">geom =</span> <span class="st">"density_ridges_gradient"</span>, </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">calc_ecdf =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Tail Prob."</span>, </span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> <span class="st">"mako"</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mother's Education"</span>, </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"GPA Score"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>all_plot_tail <span class="ot">&lt;-</span> p_fa_tail <span class="sc">+</span> p_mo_tail <span class="sc">+</span> </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Student Probability Distribution of GPA by Parental Education"</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of GPA distribution shifts, highlighting the narrower variance and stronger core concentration in mother's education groups"</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>all_plot_tail</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>😺 Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>First, we’ve just observed from the tunnel plot that the darkest areas of highest student density show a continuous rightward shift as parental education levels increase. This further confirms our assessment that higher parental education levels are more conducive to cultivating top students and also help prevent children from achieving excessively low grades.</p></li>
<li><p>Comparing the two plots, the darkest core area for mothers appears more compact and sharper than for fathers. Furthermore, the high density near the median suggests that mothers’ education levels may play a more significant role in students’ GPAs than fathers’.</p></li>
</ul>
</div>
</div></li>
</ul>
</section>
<section id="viz4-high-gpa-students-spent-more-time-on-study-while-spent-less-on-social-media" class="level2">
<h2 class="anchored" data-anchor-id="viz4-high-gpa-students-spent-more-time-on-study-while-spent-less-on-social-media">Viz4: High GPA students spent more time on study while spent less on social media</h2>
<p>Here, I use a <strong>ternary plot</strong> to show the proportions of students spending time on three categories of daily activities (studying/social media/going out with friends). I also color-code points according to different GPA categories to reflect the distribution differences among different GPA categories. The implementation process is as follows: First, I convert the grouping intervals of the three time variables into midpoints for easier comparison, based on the official codebook. For example, social media and going out with friends are 0.5/1.5/2.5/3.5/4.5, while study time—less than 2 hours of study time—is 1, and so on, 3/5/7/9. Then, I obtain three new variables, sm_new, fri_new, and st_new, from the defined midpoints. By calculating the total time (total), and dividing the three new variables by total, I obtain their respective proportions, sm_p, fri_p, and st_p.&nbsp;Finally, I convert GPA_Cat into a factor, use <strong>ggtern()</strong> to draw the plot, and color-code it according to GPA category to observe the clustering trend of different GPA groups in the three types of time allocation.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>midp_sm_fri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>) </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>midp_study  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>time_tri_mutated <span class="ot">&lt;-</span> final_ggplot <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># turn categorical variable into midpoint value</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_val =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_SocicalMedia)],</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fri_val =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_Friends)],</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">st_val  =</span> midp_study[<span class="fu">as.integer</span>(Time_Studying)],</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL =</span> sm_val <span class="sc">+</span> fri_val <span class="sc">+</span> st_val</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TOTAL <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#plot </span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtern</span>(<span class="at">data =</span> time_tri_mutated, <span class="fu">aes</span>(<span class="at">x =</span> st_val, <span class="at">y =</span> sm_val, <span class="at">z =</span> fri_val, <span class="at">colour =</span> GPA_Label)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"High GPA students spent more time on study while spent less on social media"</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ternary plot shows the trade-off between Study, Social Media, and Friends"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"GPA Category"</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_rgbw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1248"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>😺 Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>As can be seen from the distribution of the data points, most points are clearly clustered near the Social Media area, while there is almost no clustering near the Study and Outings locations. This indicates that most students in the sample spend their time on social media, with relatively less time allocated to studying and outings.</p></li>
<li><p>At the GPA category level, the distribution of points within each subcategory has a high degree of overlap, and the hypothetical scenario of “high GPA being significantly closer to the learning peak” does not occur. Here we can conclude that judging by the proportion of time spent near the midpoint of the interval, the differences in GPA between groups may be weak. Further statistical tests are needed to confirm this (testing each of the three variables against the GPA Category will yield a more rigorous conclusion).</p></li>
</ul>
</div>
</div></li>
</ul>
<section id="viz5-does-high-gpa-students-spent-less-time-on-social-media-and-more-on-study" class="level3">
<h3 class="anchored" data-anchor-id="viz5-does-high-gpa-students-spent-less-time-on-social-media-and-more-on-study">Viz5: Does high GPA students spent less time on social media and more on study?</h3>
<p>First, I use <strong>ggbetweenstats()</strong> to test and display the differences between the three time variables and GPA groups. Since the upper limits of the scales for the three time variables are inconsistent (the highest for study time is “≥8 hours”, while the highest for others is “&gt;4 hours”), to ensure comparability, I converted each category to an <strong>interval midpoint</strong> according to the official codebook, thus unifying the unit of measurement to “hours”. After mapping the midpoints, I then generated three numerical variables—Study_hours, Media_hours, and Friends_hours—based on the selected fields, and performed tests with GPA_Cat as the grouping variable (x) and time as y.</p>
<p>For statistical testing, considering that the distribution of the time variables may be non-normal and that the sample sizes between groups are unbalanced, I still used the <strong>Kruskal-Wallis nonparametric test</strong> to attempt to test the differences in time allocation among different GPA groups.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use mutate</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_time_analysis <span class="ot">&lt;-</span> final_ggplot <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">st_hours  =</span> midp_study[<span class="fu">as.integer</span>(Time_Studying)],</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_hours  =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_SocicalMedia)],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fri_hours =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_Friends)],</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL     =</span> st_hours <span class="sc">+</span> sm_hours <span class="sc">+</span> fri_hours</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TOTAL <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggbetweenstats </span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>viz_study <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_time_analysis,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> GPA_Label,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> st_hours,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>, <span class="co">#non-parametric</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Study hours across GPA categories"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"GPA Category"</span>, </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Study Time (hours)"</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>viz_media <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_time_analysis,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> GPA_Label,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> sm_hours,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Social media time across GPA categories"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"GPA Category"</span>, </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Social Media Time (hours)"</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>viz_friends <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_time_analysis,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> GPA_Label,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> fri_hours,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Time spent with friends across GPA categories"</span>,</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"GPA Category"</span>, </span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Friends Time (hours)"</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a><span class="co">#patchwork</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>(viz_study) <span class="sc">/</span> (viz_media <span class="sc">|</span> viz_friends)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>😺 Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>To compare students’ time-use distributions across GPA groups, we applied the Kruskal–Wallis (non-parametric) test. All three time variables were statistically significant across GPA categories. • Study time: Median study time was 9 hours for every GPA group, mainly because many students fall into the ≥8 hours band. The clearest difference is that the lower-GPA group has a higher share of students with shorter study time. • Social media time: The lower-GPA group shows a higher median social media time, suggesting they spend more time on social media.</p>
<p>• Friends time: Median differences are small; significance indicates only a weak relationship with GPA. Overall, effect sizes are small, meaning differences are modest and driven more by distributional shifts than large between-group gaps.</p>
</div>
</div>
</section>
</section>
<section id="student-perceptions-and-learning-environment" class="level2">
<h2 class="anchored" data-anchor-id="student-perceptions-and-learning-environment">6 Student Perceptions and Learning Environment</h2>
<p>In section 5, we explored the relationship and differences between behavior and GPA. Now, let’s move on to the next section on perception. After completing the previous section, I couldn’t help but wonder: besides behavior, are there also systemic differences between perceptual experience and GPA? Which perceptual dimensions are most relevant?</p>
<section id="viz6-students-are-most-satisfied-with-school-but-personal-habits-still-decides-at-certain-cases" class="level3">
<h3 class="anchored" data-anchor-id="viz6-students-are-most-satisfied-with-school-but-personal-habits-still-decides-at-certain-cases">Viz6: Students are most satisfied with school but personal habits still decides at certain cases</h3>
<p>This figure uses <strong>HH</strong> to plot, illustrating the frequency distribution of students’ responses to eight learning perception items on a 1–5 Likert scale. First, the eight variables (table b) were extracted from final_ggplot, and then convert the wide table to a long table, resulting in two columns: Measure and Response. I then created a contingency table for these two columns, converting each row to a percentage. This was done to eliminate the impact of sample size differences on the graph’s scale. Finally, I used the HH::<strong>likert()</strong> function to plot the Diverging Stacked Bar, using percentages as a uniform measure to directly show the differences and frequency distribution of each variable.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>survey_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Study_Methods"</span>, <span class="st">"SupportOf_Uni"</span>, <span class="st">"SupportOf_Lec"</span>, <span class="st">"Facilitie_Uni"</span>, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quality_Lecturer"</span>, <span class="st">"TrainingCurriculum"</span>, <span class="st">"Competitive_Class"</span>, <span class="st">"InfuenceF_Friends"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare long table</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>survey_long <span class="ot">&lt;-</span> final_ggplot[, survey_vars] <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(measure, response)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting to factor</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>survey_long<span class="sc">$</span>measure <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(survey_long<span class="sc">$</span>measure)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>survey_long<span class="sc">$</span>response <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(survey_long<span class="sc">$</span>response)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the contingency table</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>survey_df <span class="ot">&lt;-</span> <span class="fu">table</span>(survey_long<span class="sc">$</span>measure, survey_long<span class="sc">$</span>response) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame.matrix</span>()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the column name</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(survey_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(survey_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Class Competition"</span>, <span class="st">"University Facilities"</span>, <span class="st">"Peer Influence"</span>, </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Lecturer Support"</span>, <span class="st">"Lecturer Quality"</span>, <span class="st">"Study Methods"</span>, </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"University Support"</span>, <span class="st">"Training Curriculum"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the dataframe row name</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>survey_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(survey_df, <span class="at">var =</span> <span class="st">"Measure"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plot using HH package</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="fu">likert</span>(Measure <span class="sc">~</span> ., </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> survey_df, </span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">ReferenceZero =</span> <span class="dv">3</span>, </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">as.percent =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">positive.order =</span> <span class="cn">TRUE</span>, </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">list</span>(<span class="st">" Most of Students are generally satisfied with Learning Perceptions"</span>, <span class="at">x =</span> <span class="fu">unit</span>(.<span class="dv">55</span>, <span class="st">"npc"</span>)), </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">"Satisfaction Rating (1-5 Scale)"</span>, <span class="at">x =</span> <span class="fu">unit</span>(.<span class="dv">57</span>, <span class="st">"npc"</span>)),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="sc">-</span><span class="dv">80</span>, <span class="sc">-</span><span class="dv">60</span>, <span class="sc">-</span><span class="dv">40</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">strip =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"></ul>
<div class="tab-content">

</div>
</div></li>
</ul>
</section>
<section id="viz7-does-gpa-have-the-relationship-with-perception-variables" class="level3">
<h3 class="anchored" data-anchor-id="viz7-does-gpa-have-the-relationship-with-perception-variables">Viz7: Does GPA have the relationship with perception variables?</h3>
<p>First, I selected all perceptual variables and GPA (num). Since Likert categorizes variables by class, I converted all variables into ordered numerical representations by <strong>as.numeric</strong> function. Then, I used <strong>cor(method=“spearman”)</strong> to generate the Spearman correlation matrix. Finally, I used the basic function <strong>heatmap()</strong> to visualize the correlation matrix, preserving the hierarchical clustering dendrogram to observe the similarity and clustering structure between variables.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting vars</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>var_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GPA_Num"</span>, <span class="st">"Adapt_Learning_Uni"</span>, <span class="st">"Study_Methods"</span>, <span class="st">"SupportOf_Uni"</span>, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"SupportOf_Lec"</span>, <span class="st">"Facilitie_Uni"</span>, <span class="st">"Quality_Lecturer"</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"TrainingCurriculum"</span>, <span class="st">"Competitive_Class"</span>, <span class="st">"InfuenceF_Friends"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>correl_var <span class="ot">&lt;-</span> final_ggplot[, var_list]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># turn into numerical as.numeric</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>GPA_Num           <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>GPA_Num))</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Adapt_Learning_Uni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Adapt_Learning_Uni))</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Study_Methods     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Study_Methods))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>SupportOf_Uni     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>SupportOf_Uni))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>SupportOf_Lec     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>SupportOf_Lec))</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Facilitie_Uni     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Facilitie_Uni))</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Quality_Lecturer  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Quality_Lecturer))</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>TrainingCurriculum <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>TrainingCurriculum))</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Competitive_Class <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Competitive_Class))</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>InfuenceF_Friends <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>InfuenceF_Friends))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co"># spearman matrix</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>wh_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(correl_var, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>wh_matrix[<span class="fu">is.na</span>(wh_matrix)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="co"># plot heatmap</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  wh_matrix,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rowv =</span> <span class="cn">NA</span>, <span class="at">Colv =</span> <span class="cn">NA</span>,         </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="st">"none"</span>, </span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">cexRow =</span> <span class="fl">0.9</span>, <span class="at">cexCol =</span> <span class="fl">0.9</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">10</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Does GPA have the relationship with perception variables?"</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex01final_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>😺 Observations
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>We can easily observe significant positive correlations among the nine learning perception variables (darker areas), indicating that these perception dimensions are interdependent and related. For example, “school support/teacher support/curriculum and facilities” tend to cluster together, suggesting a high degree of consistency in students’ overall evaluations of the learning environment and teachers.</p></li>
<li><p>Notably, the GPA_Num row/column is very light in color, indicating almost no correlation between GPA and the learning perception variables. The overall trend is that the perception variables have a strong synergistic effect, while GPA has virtually no relationship with any single perception variable.</p></li>
</ul>
</div>
</div></li>
</ul>
</section>
</section>
</section>
<section id="summary" class="level1">
<h1>7. Summary</h1>
<p>This paper’s exploratory data visualization analysis goes beyond simply representing the data; it transforms tabular data into actionable behavioral insights. While the original statistical tests (e.g., Tables 4 and 7 on the research paper <a href="https://www.sciencedirect.com/science/article/pii/S2352340925001702" class="uri">https://www.sciencedirect.com/science/article/pii/S2352340925001702</a>) confirm basic correlations, our visualization model further reveals the potential dynamics of how these variables interact in students’ daily lives.</p>
<div>
<ul>
<li><div>
<h2 id="key-findings" class="anchored" data-anchor-id="summary">7.1 Key Findings:</h2>
<ul>
<li><p>Table 3 shows that most students’ GPAs hover around 3.0 (“Good” to “Excellent”), while the ridgeline plot visualizes a phenomenon: as students approach graduation, the distribution of high-achieving students becomes significantly more concentrated, suggesting a unique adaptation curve that the original mean cannot capture.</p></li>
<li><p>Table 4 shows that both parents’ educational backgrounds are significantly correlated with GPA. Similarly, the funnel density plot reveals a deeper, clearer, and more concentrated impact of maternal education on students’ academic performance, preventing extremely low scores.</p></li>
<li><p>Table 1 shows that over 82% of students study for more than 8 hours a day. Conversely, our ternary plot and KW test box plot reveal a key paradox: the length of study time does not guarantee a high GPA. The real difference lies in social media. It can be seen that the median time spent on social media is significantly higher among those with lower GPAs, reducing their substantial study time.</p></li>
<li><p>Table 2 highlights the generally positive student satisfaction with university facilities and lecturer quality. However, based on Likert distribution and correlation heatmaps (inspired by the weak Pearson correlation in Table 5), GPA is not correlated with students’ positive evaluations of campus facilities/faculty; instead, individual study methods and adaptability deserve attention.</p></li>
</ul>
</div></li>
</ul>
</div>
<div>
<ul>
<li><div>
<h2 id="recommendations" class="anchored">7.2 Recommendations:</h2>
<ul>
<li><p>Students’ average study time exceeds 8 hours, so the time aspect is not the problem; the more important issue is the quality. Future surveys could focus on questions such as how many hours of focused study time are taken (without interruptions).</p></li>
<li><p>Living in the digital age, we must acknowledge that social media occupies a significant portion of students’ time. Therefore, schools should take action to restrict some social media use (e.g., prohibiting mobile phones on campus), which could significantly improve students’ average GPA.</p></li>
<li><p>In addition to the school’s own advantages (teachers, facilities), universities should pay more attention to the learning methods and adaptation of students with low GPAs or lower-year students, provide more psychological counseling and outreach activities, and improve students’ satisfaction with other perceived factors.</p></li>
</ul>
</div></li>
</ul>
</div>
</section>
<section id="references" class="level1">
<h1>8.References</h1>
<ul>
<li><p>Prof Kam, Tin Seong. (2026). Visualising Distribution. <em>R for Visual Analytics.</em><a href="https://r4va.netlify.app/chap08" class="uri">https://r4va.netlify.app/chap08</a></p></li>
<li><p>Tran, Vinh Doan, Nguyen, Kim Son Thi, &amp; Le, Diep Ngoc. (2025). Dataset of factors affecting learning outcomes of students at the University of Education, Vietnam National University, Hanoi. <a href="https://www.sciencedirect.com/science/article/pii/S2352340925001702" class="uri">https://www.sciencedirect.com/science/article/pii/S2352340925001702</a></p></li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Take-home Exercise 1final"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Zhiyi Hao"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2026/02/05"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show     </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">    backgroundcolor: white</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">    fontcolor: black</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">    linkcolor: blue</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1.Overview</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Background</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>Nowadays, researchers have long been dedicated to researching the factors influencing student academic performance. The dataset used in this analysis comes from VNU University of Education and aims to comprehensively explore the deep relationship between various real-world factors and student academic achievement (GPA).</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>The survey was conducted from March to June 2023, collecting 2,170 responses from students. The data primarily covers two core dimensions: 1) students' demographic characteristics and lifestyle habits (e.g., Academic Year, parental educational background, allocation of their time); 2) students' learning perceptions at university(e.g., feelings of teaching quality, facilities, influence from friends etc.).</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>Through exploratory data analysis (EDA) of these different types of data, we hope to identify the key indicators may affectiing students' GPA and find relationships. This will not only provide school administrators with objective feedback but also help teachers and academic advisors better understand the factors influencing student performance, and also enabling them to take measures if needed to improve overall teaching effectiveness.</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 The Data</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>The data for this exercise is the Student questionnaire data(database paper) file in .xlsx format, retrieved from <span class="co">[</span><span class="ot">Mendeley Data Repository</span><span class="co">](https://data.mendeley.com/datasets/23ppcdbmhc/1)</span>. <span class="al">![](image1.png)</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>Supplementary materials used in conjunction with dataset:</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="co">[</span><span class="ot">Codebook</span><span class="co">](https://data.mendeley.com/datasets/23ppcdbmhc/1)</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3 The Task</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>Based on the 2023 VNU Student Questionnaire Dataset, this post aims to reveal followings by using appropriate **Exploratory Data Analysis (EDA) methods** and **the ggplot2 package**</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the distribution of academic performance (GPA)across different year students at Vietnam National University</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the relationships between these academic performances and family socioeconomic status (parental education level), personal behavioral habits (time spent studying and social media), and perception varaibles.</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2.Loading Packages</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>In this exercise, several R packages will be used. They are listed in the table below:</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Library <span class="pp">|</span> Description <span class="pp">|</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="pp">|:-----------------------------------|:-----------------------------------|</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**tidyverse**</span><span class="co">](https://www.tidyverse.org/)</span> <span class="pp">|</span> A collection of core packages used for data preparation and wrangling. <span class="pp">|</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**knitr**</span><span class="co">](https://yihui.org/knitr/)</span> <span class="pp">|</span> For dynamic report generation. <span class="pp">|</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**patchwork**</span><span class="co">](https://patchwork.data-imaginist.com/)</span> <span class="pp">|</span> For preparing composite figure created using ggplot2. <span class="pp">|</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**ggridges**</span><span class="co">](https://wilkelab.org/ggridges/)</span> <span class="pp">|</span> For ridgeline plots that create the impression of a mountain range.can be useful for visualising changes in distributions over time. <span class="pp">|</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**ggdist**</span><span class="co">](https://mjskay.github.io/ggdist/)</span> <span class="pp">|</span> For visualisations of distributions and uncertainty. Key package for creating Raincloud Plots. <span class="pp">|</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**HH**</span><span class="co">](https://cran.r-project.org/web/packages/HH/HH.pdf)</span> <span class="pp">|</span> particularly known for its likert() function which creates diverging stacked bar charts for Likert scale dataspecialized. <span class="pp">|</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**ggtern**</span><span class="co">](https://cloud.r-project.org/web/packages/ggtern/ggtern.pdf)</span> <span class="pp">|</span> a ggplot extension specially designed to plot ternary diagrams. The package will be used to plot static ternary plots. <span class="pp">|</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="co">[</span><span class="ot">**ggstatsplot**</span><span class="co">](https://indrajeetpatil.github.io/ggstatsplot/)</span> <span class="pp">|</span> {ggstatsplot} is an extension of {ggplot2} package for creating graphics with details from statistical tests included in the information-rich plots themselves. <span class="pp">|</span></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>The following code chunk uses <span class="in">`p_load()`</span> of <span class="co">[</span><span class="ot">**pacman**</span><span class="co">](https://rpubs.com/akshaypatankar/594834)</span> package to check if tidyverse packages are installed in the computer. If they are, the libraries will be called into R.</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>  tidyverse,    </span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  knitr,       </span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>  patchwork,    </span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>  ggridges,     </span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  ggtern,      </span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  HH,           </span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  ggstatsplot   </span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3.Data Import</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>In sections 3 and 4, I will explain all the steps of data processing — from reading the raw data to generating the final dataset. I will use the tidyverse package for data cleaning and readxl for reading the data.</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.1 Importing .xlsx file</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>The following code block uses the <span class="in">`read_excel()`</span> function from the <span class="in">`readxl`</span> package to import the original dataset. This data originates from the file <span class="in">`Database paper.xlsx`</span>.</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>raw_dataset <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/Database paper.xlsx"</span>)</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>raw_dataset</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>This dataset contains 2,170 observations (rows) and 22 variables (columns). Each observation corresponds to a participating student or alumnus, and the variables cover students' demographic characteristics, family background, and perceptions of the school environment.</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3.2 Duplicates Check</span></span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>To ensure data quality, we need to check there are duplicated records in the dataset.</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(raw_dataset))</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(raw_dataset)</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>We can find the duplicated record is 226 out of the raw data sample of 2170, however, there is no distinct record like ID in our dataset, we can't treat all duplicated data as the true duplicated ones. Since repeated response patterns may represent the true frequency in the population, duplication based solely on identical values in the survey variables could distort the empirical distribution and introduce bias into subsequent analyses. Therefore, we retained all records.</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4.Data Wrangling</span></span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>Since the raw_dataset contains a large number of numerical codes without labels, it is not suitable for direct analysis. Therefore, I strictly followed the official codebook and cleaned and standardized the data through the following steps.</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1 Variable Selection</span></span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>First, I select some useful variables required for EDA process and ensure the raw column names are consistently referenced. To ensure that the variables for subsequent visualization are cleaned, we should eliminate noise(drop useless variables). For the selection of direct variables, I chose to retain only those directly related to demographics, learning habits, and personal perceptions. In this step, I specifically excluded the following variables for the following reasons:</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Gender(A.2): To focus the analysis on universally applicable learning strategies and perceptual dimensions, gender was considered noise and therefore excluded.</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Socioeconomic indicators (A.3, A.4, A.5): I excluded "policy support," "minority status," and "poverty status." This analysis emphasizes individual student behaviors more than macro-level "socioeconomic background factors."</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Parental Occupation indicators (A.8, A.9): I selected "parents' education level" and excluded "parents' occupation." In educational research, education level is generally considered a more stable and explanatory indicator of family cultural capital.</span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>Since most variables in the original dataset were numerical, I recoded them into meaningful and easily interpretable category labels according to the official coding manual. This step involved converting the raw data into ordinal factors (e.g., converting "1, 2, 3" into "none, moderate, very"), thus ensuring that subsequent visualizations and statistical tests were ordinal and valid.</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a>final_ggplot <span class="ot">&lt;-</span> raw_dataset</span>
<span id="cb21-122"><a href="#cb21-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-123"><a href="#cb21-123" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Year_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Year, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"First-year"</span>, <span class="st">"Second-year"</span>, <span class="st">"Third-year"</span>, <span class="st">"Fourth-year"</span>, <span class="st">"Graduated"</span>))</span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Father_Edu_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Father_Edu, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Primary"</span>, <span class="st">"Secondary"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"University/Grad"</span>, <span class="st">"Other"</span>))</span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Mother_Edu_Label <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Mother_Edu, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, </span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Primary"</span>, <span class="st">"Secondary"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, <span class="st">"University/Grad"</span>, <span class="st">"Other"</span>))</span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Friends_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Time_Friends, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;1h"</span>, <span class="st">"1-2h"</span>, <span class="st">"2-3h"</span>, <span class="st">"3-4h"</span>, <span class="st">"&gt;=4h"</span>))</span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Social_Media_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Time_SocicalMedia, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;1h"</span>, <span class="st">"1-2h"</span>, <span class="st">"2-3h"</span>, <span class="st">"3-4h"</span>, <span class="st">"&gt;=4h"</span>))</span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Time_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Time_Studying, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;2h"</span>, <span class="st">"2-4h"</span>, <span class="st">"4-6h"</span>, <span class="st">"6-8h"</span>, <span class="st">"&gt;=8h"</span>))</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Label <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>GPA, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"&lt;2.0 (Poor)"</span>, <span class="st">"2.0–2.5 (Avg)"</span>, <span class="st">"2.5–3.2 (Fair)"</span>, <span class="st">"3.2–3.6 (Good)"</span>, <span class="st">"&gt;=3.6 (Excl)"</span>))</span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>gpa_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.50</span>, <span class="fl">2.25</span>, <span class="fl">2.85</span>, <span class="fl">3.40</span>, <span class="fl">3.85</span>)</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Num <span class="ot">&lt;-</span> gpa_map[<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(final_ggplot<span class="sc">$</span>GPA))]</span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Adapt_Learning_Uni <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Adapt_Learning_Uni, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Methods      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Study_Methods, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>SupportOf_Uni      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>SupportOf_Uni, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>SupportOf_Lec      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>SupportOf_Lec, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Facilitie_Uni      <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Facilitie_Uni, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Quality_Lecturer   <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Quality_Lecturer, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>TrainingCurriculum <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>TrainingCurriculum, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Competitive_Class  <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>Competitive_Class, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>InfuenceF_Friends  <span class="ot">&lt;-</span> <span class="fu">ordered</span>(final_ggplot<span class="sc">$</span>InfuenceF_Friends, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a><span class="co">#mapping GPA into numerical form GPA_Num</span></span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Methods_Raw <span class="ot">&lt;-</span> raw_dataset<span class="sc">$</span>Study_Methods</span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Raw <span class="ot">&lt;-</span> raw_dataset<span class="sc">$</span>GPA</span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>gpa_map <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.50</span>, <span class="fl">2.25</span>, <span class="fl">2.85</span>, <span class="fl">3.40</span>, <span class="fl">3.85</span>)</span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>GPA_Num <span class="ot">&lt;-</span> gpa_map[<span class="fu">as.numeric</span>(<span class="fu">as.character</span>(final_ggplot<span class="sc">$</span>GPA_Raw))]</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>final_ggplot<span class="sc">$</span>Study_Methods_Fix <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_ggplot<span class="sc">$</span>Study_Methods_Raw, </span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>))</span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>Note:Under is <span class="sc">\&lt;</span>, Over is <span class="sc">\&gt;</span>=, use symbols simplifies the final presentation.</span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2 Final checks for dataset quality</span></span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a><span class="co">#check if GPA_Num exists and missing value</span></span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_ggplot<span class="sc">$</span>GPA_Num)</span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a><span class="fu">anyNA</span>(final_ggplot)</span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>The final checks confirmed that the dataset contained no missing values and no duplicate rows. Furthermore, all ordered variables were presented in the order of the official codebook.</span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>After doing these two checks, we can make sure the data quality is good(no missing value, normal distribution,factor order is correct) and it is applicable for EDA process.</span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5.0 Exploratory Data Analysis (EDA)</span></span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a>After data cleaning, we move on to the Exploratory Data Analysis (EDA). This chapter aims to use packages in R to create visualizations that reveal potential relationship in student demographics, behavioral habits, and academic performance.</span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a>This section has two parts, Group A and Group B, which coresponds to section 5 Academic Performance and Demographic Characteristics and 6 Student Perceptions and Learning Environment. Let's start our analysis!</span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a><span class="fu"># 5 Academic Performance and Demographic Characteristics</span></span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a><span class="fu">## Viz1: Academic performance exhibits high median stability but increasing divergence in later study years</span></span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>To explore the evolution of GPA distribution across different grade levels, I first cleaned the raw data. I mapped the categorical variable GPA to numerical midpoints (e.g., mapping grade 1 to 1.50 and grade 5 to 3.85), making GPA an analyzable numerical score for easy visualization. Next, I used the ggridges package to create a ridge plot to show the probability density distribution of grades across grade levels. Then, I used stat_density_ridges to automatically calculate quantiles. The extreme 2.5% regions at both ends of the distribution are highlighted in red and blue in the plot. This approach not only visually presents the central tendency of grades across grade levels but also effectively identifies the proportion of students with abnormally high or low GPAs.</span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a><span class="co">#stats(quantile)</span></span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(final_ggplot, </span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GPA_Num, </span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Year_Label, </span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">factor</span>(<span class="fu">stat</span>(quantile)))) <span class="sc">+</span> </span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(</span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">geom =</span> <span class="st">"density_ridges_gradient"</span>,</span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">calc_ecdf =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a>    <span class="at">quantiles =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Probability"</span>,</span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FF0000A0"</span>, <span class="st">"#A0A0A0A0"</span>, <span class="st">"#0000FFA0"</span>),</span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"(0, 0.025]"</span>, <span class="st">"(0.025, 0.975]"</span>, <span class="st">"(0.975, 1]"</span>)</span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a> <span class="fu">labs</span>(</span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Student GPA Scores by Academic Year"</span>,</span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Academic performance exhibits high median stability but increasing divergence in later study years"</span>,</span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"GPA Score (Mapping GPA category)"</span>,</span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Academic Year"</span></span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray30"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">b =</span> <span class="dv">10</span>)),</span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"plain"</span>),</span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">"plain"</span>),</span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span></span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>::: {.callout-note icon="false"}</span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a>    ## 😺 Observations</span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overall, the GPA of students across all grades is around 3.0 (between Fair and Good), showing a significant peak. This indicates that the school's students have very stable academic performance, with no extremely low scores, and the overall teaching quality is good.</span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>As students progress through the years, they should be more adapted to university life, but the red zone on the left remains stable across all grades, especially in the third year. The reason for such a high proportion may need to be explored in terms of student perception or other aspects, such as their level of adaptation.</span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Towards graduation, the density of the blue zone on the right increases slightly, and the curve slopes more pronounced to the right. This may be because students nearing graduation have found a better study method, thus learning better and faster, resulting in a higher probability of having a high GPA.</span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a>    :::</span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Viz2: Higher parental education significantly boosts the probability of achieving a high GPA</span></span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a>I first defined a high GPA (same as year). A student's GPA was recorded as TRUE if it was in the range of "3.2-3.6 (Good)" or "≥3.6 (Excellent)," and as FALSE otherwise. This binary variable fairly compares the relationship between parental education level and GPA. Next, I summarized the data by Father_Edu_Label and Mother_Edu_Label, calculating the sample size and high GPA rate for each group. Then, to determine the baseline for the funnel plot, I calculated a weighted average of these rates with a weight of $1/se^2$ to ensure that groups with larger sample sizes and more stable estimates have a greater impact on the overall mean. Next, I generated 95% (dashed line) and 99.9% (solid line) confidence intervals to define the expected range of variation. Finally, I constructed the funnel plot using ggplot2, applied geom_text to add labels for each education group, and ensured readability by managing label overlap.</span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a>Father's education background</span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a><span class="co"># compute high GPA rate</span></span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a>high_gpa <span class="ot">&lt;-</span> final_ggplot<span class="sc">$</span>GPA_Label <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3.2–3.6 (Good)"</span>, <span class="st">"&gt;=3.6 (Excl)"</span>)</span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a>n_tab <span class="ot">&lt;-</span> <span class="fu">table</span>(final_ggplot<span class="sc">$</span>Father_Edu_Label)</span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>rate_tab <span class="ot">&lt;-</span> <span class="fu">tapply</span>(high_gpa, final_ggplot<span class="sc">$</span>Father_Edu_Label, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-277"><a href="#cb21-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">names</span>(n_tab),</span>
<span id="cb21-278"><a href="#cb21-278" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positive =</span> <span class="fu">as.numeric</span>(n_tab),</span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">as.numeric</span>(rate_tab)</span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-281"><a href="#cb21-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-282"><a href="#cb21-282" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude the small size group</span></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[df<span class="sc">$</span>Positive <span class="sc">&gt;=</span> <span class="dv">5</span>, ]</span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>rate.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((df<span class="sc">$</span>rate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> df<span class="sc">$</span>rate)) <span class="sc">/</span> df<span class="sc">$</span>Positive)</span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a><span class="co">#compute fit.mean</span></span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a>fit.mean <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(df<span class="sc">$</span>rate, <span class="dv">1</span> <span class="sc">/</span> df<span class="sc">$</span>rate.se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate lower and upper limits for 95% and 99.9% CI</span></span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>number.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(df<span class="sc">$</span>Positive), <span class="dv">1</span>)</span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>number.ll95  <span class="ot">&lt;-</span> fit.mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>number.ul95  <span class="ot">&lt;-</span> fit.mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a>number.ll999 <span class="ot">&lt;-</span> fit.mean <span class="sc">-</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a>number.ul999 <span class="ot">&lt;-</span> fit.mean <span class="sc">+</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a>dfCI <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(number.ll95, number.ul95, number.ll999, number.ul999, number.seq, fit.mean)</span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Positive, <span class="at">y =</span> rate)) <span class="sc">+</span></span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Group), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll95), </span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul95), </span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll999), </span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul999), </span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dfCI, <span class="fu">aes</span>(<span class="at">yintercept =</span> fit.mean), </span>
<span id="cb21-307"><a href="#cb21-307" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb21-308"><a href="#cb21-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-309"><a href="#cb21-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb21-310"><a href="#cb21-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> <span class="st">"99.9%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"High GPA Rate by Father's Educational Background"</span>) <span class="sc">+</span></span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size"</span>) <span class="sc">+</span> </span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"High GPA Rate (&gt;= 3.2)"</span>) <span class="sc">+</span></span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a>p1</span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a>Mother's education background</span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-326"><a href="#cb21-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a><span class="co"># compute </span></span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>high_gpa <span class="ot">&lt;-</span> final_ggplot<span class="sc">$</span>GPA_Label <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"3.2–3.6 (Good)"</span>, <span class="st">"&gt;=3.6 (Excl)"</span>)</span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a>n_tab_m <span class="ot">&lt;-</span> <span class="fu">table</span>(final_ggplot<span class="sc">$</span>Mother_Edu_Label)</span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a>rate_tab_m <span class="ot">&lt;-</span> <span class="fu">tapply</span>(high_gpa, final_ggplot<span class="sc">$</span>Mother_Edu_Label, mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a>df_m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> <span class="fu">names</span>(n_tab_m),</span>
<span id="cb21-336"><a href="#cb21-336" aria-hidden="true" tabindex="-1"></a>  <span class="at">Positive =</span> <span class="fu">as.numeric</span>(n_tab_m),</span>
<span id="cb21-337"><a href="#cb21-337" aria-hidden="true" tabindex="-1"></a>  <span class="at">rate =</span> <span class="fu">as.numeric</span>(rate_tab_m)</span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-339"><a href="#cb21-339" aria-hidden="true" tabindex="-1"></a>df_m <span class="ot">&lt;-</span> df_m[df_m<span class="sc">$</span>Positive <span class="sc">&gt;=</span> <span class="dv">5</span>, ]</span>
<span id="cb21-340"><a href="#cb21-340" aria-hidden="true" tabindex="-1"></a>df_m<span class="sc">$</span>rate.se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((df_m<span class="sc">$</span>rate <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> df_m<span class="sc">$</span>rate)) <span class="sc">/</span> df_m<span class="sc">$</span>Positive)</span>
<span id="cb21-341"><a href="#cb21-341" aria-hidden="true" tabindex="-1"></a><span class="co">#compute fit.mean</span></span>
<span id="cb21-342"><a href="#cb21-342" aria-hidden="true" tabindex="-1"></a>fit.mean_m <span class="ot">&lt;-</span> <span class="fu">weighted.mean</span>(df_m<span class="sc">$</span>rate, <span class="dv">1</span> <span class="sc">/</span> df_m<span class="sc">$</span>rate.se<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb21-343"><a href="#cb21-343" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate lower and upper limits for 95% and 99.9% CI</span></span>
<span id="cb21-344"><a href="#cb21-344" aria-hidden="true" tabindex="-1"></a>number.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">max</span>(df_m<span class="sc">$</span>Positive), <span class="dv">1</span>)</span>
<span id="cb21-345"><a href="#cb21-345" aria-hidden="true" tabindex="-1"></a>number.ll95  <span class="ot">&lt;-</span> fit.mean_m <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-346"><a href="#cb21-346" aria-hidden="true" tabindex="-1"></a>number.ul95  <span class="ot">&lt;-</span> fit.mean_m <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-347"><a href="#cb21-347" aria-hidden="true" tabindex="-1"></a>number.ll999 <span class="ot">&lt;-</span> fit.mean_m <span class="sc">-</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-348"><a href="#cb21-348" aria-hidden="true" tabindex="-1"></a>number.ul999 <span class="ot">&lt;-</span> fit.mean_m <span class="sc">+</span> <span class="fl">3.29</span> <span class="sc">*</span> <span class="fu">sqrt</span>((fit.mean_m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> fit.mean_m)) <span class="sc">/</span> number.seq)</span>
<span id="cb21-349"><a href="#cb21-349" aria-hidden="true" tabindex="-1"></a>dfCI_m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(number.ll95, number.ul95, number.ll999, number.ul999, number.seq, fit.mean_m)</span>
<span id="cb21-350"><a href="#cb21-350" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb21-351"><a href="#cb21-351" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_m, <span class="fu">aes</span>(<span class="at">x =</span> Positive, <span class="at">y =</span> rate)) <span class="sc">+</span></span>
<span id="cb21-352"><a href="#cb21-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb21-353"><a href="#cb21-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Group), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-354"><a href="#cb21-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll95), </span>
<span id="cb21-355"><a href="#cb21-355" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-356"><a href="#cb21-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul95), </span>
<span id="cb21-357"><a href="#cb21-357" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-358"><a href="#cb21-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ll999), </span>
<span id="cb21-359"><a href="#cb21-359" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb21-360"><a href="#cb21-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">x =</span> number.seq, <span class="at">y =</span> number.ul999), </span>
<span id="cb21-361"><a href="#cb21-361" aria-hidden="true" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> dfCI_m, <span class="fu">aes</span>(<span class="at">yintercept =</span> fit.mean_m), </span>
<span id="cb21-363"><a href="#cb21-363" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.4</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb21-364"><a href="#cb21-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df_m<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean_m <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">max</span>(df_m<span class="sc">$</span>Positive)<span class="sc">*</span><span class="fl">0.95</span>, <span class="at">y =</span> fit.mean_m <span class="sc">+</span> <span class="fl">0.15</span>, <span class="at">label =</span> <span class="st">"99.9%"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"grey40"</span>) <span class="sc">+</span> </span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"High GPA Rate by Mother's Educational Background"</span>) <span class="sc">+</span></span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Sample Size (n)"</span>) <span class="sc">+</span> </span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"High GPA Rate (&gt;= 3.2)"</span>) <span class="sc">+</span></span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>) </span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>p2</span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>::: {.callout-note icon="false"}</span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a>    ## 😺 Observations</span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Both graphs show that the points for the University/Graduate education group are generally higher, while those for Primary School/Secondary School are lower. This suggests strongly a positive correlation between parental education level and the probability of their child achieving a high GPA.</span>
<span id="cb21-381"><a href="#cb21-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-382"><a href="#cb21-382" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Furthermore, most points fall within the 95%/99% threshold, indicating no significant differences within the sample size and normal levels compared to the overall average.</span>
<span id="cb21-383"><a href="#cb21-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-384"><a href="#cb21-384" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>From an overall perspective, therefore, we can conclude that while there is a trend where higher parental education levels generally correlate with higher GPA rates.</span>
<span id="cb21-385"><a href="#cb21-385" aria-hidden="true" tabindex="-1"></a>    :::</span>
<span id="cb21-386"><a href="#cb21-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-387"><a href="#cb21-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## Viz3: Mother's education shows a more consistent impact on student GPA</span></span>
<span id="cb21-388"><a href="#cb21-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-389"><a href="#cb21-389" aria-hidden="true" tabindex="-1"></a>First, we need to process the fields – defining High GPA. This requires converting the original GPA_Cat into a binary variable, where high rate means: when a student's GPA falls within "3.2–<span class="sc">\&lt;</span>3.6 (Good)" or "≥3.6 (Excellent)," it is recorded as TRUE; otherwise, it is FALSE. This can be used to compare the high GPA performance of different groups. Next, we group by parent's education level and calculate the High GPA rate. First, we group separately for Father_Edu / Mother_Edu, calculating n (sample size) and rate. Then, we calculate the overall mean, using weights of 1 / rate.se\^2 to give higher weights to groups with larger sample sizes and more stable estimates. Then, we generate the 95% / 99% confidence limits for the funnel. Finally, we use the above output to generate the plot. In addition to **ggplot**, **ggrepel** is also used to prevent overlap.</span>
<span id="cb21-390"><a href="#cb21-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-393"><a href="#cb21-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-394"><a href="#cb21-394" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-395"><a href="#cb21-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb21-396"><a href="#cb21-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb21-397"><a href="#cb21-397" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 8</span></span>
<span id="cb21-398"><a href="#cb21-398" aria-hidden="true" tabindex="-1"></a>p_fa_tail <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(final_ggplot, </span>
<span id="cb21-399"><a href="#cb21-399" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> GPA_Num, <span class="at">y =</span> Father_Edu_Label, </span>
<span id="cb21-400"><a href="#cb21-400" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">stat</span>(ecdf)))) <span class="sc">+</span> </span>
<span id="cb21-401"><a href="#cb21-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">geom =</span> <span class="st">"density_ridges_gradient"</span>, </span>
<span id="cb21-402"><a href="#cb21-402" aria-hidden="true" tabindex="-1"></a>                      <span class="at">calc_ecdf =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-403"><a href="#cb21-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Tail Prob."</span>, </span>
<span id="cb21-404"><a href="#cb21-404" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb21-405"><a href="#cb21-405" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> <span class="st">"mako"</span>) <span class="sc">+</span> </span>
<span id="cb21-406"><a href="#cb21-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb21-407"><a href="#cb21-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Father's Education"</span>, </span>
<span id="cb21-408"><a href="#cb21-408" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"GPA Score"</span>, <span class="at">y =</span> <span class="st">"Education Level"</span>) <span class="sc">+</span></span>
<span id="cb21-409"><a href="#cb21-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb21-410"><a href="#cb21-410" aria-hidden="true" tabindex="-1"></a>p_mo_tail <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(final_ggplot, </span>
<span id="cb21-411"><a href="#cb21-411" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> GPA_Num, <span class="at">y =</span> Mother_Edu_Label, </span>
<span id="cb21-412"><a href="#cb21-412" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">stat</span>(ecdf)))) <span class="sc">+</span></span>
<span id="cb21-413"><a href="#cb21-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_ridges</span>(<span class="at">geom =</span> <span class="st">"density_ridges_gradient"</span>, </span>
<span id="cb21-414"><a href="#cb21-414" aria-hidden="true" tabindex="-1"></a>                      <span class="at">calc_ecdf =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-415"><a href="#cb21-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">"Tail Prob."</span>, </span>
<span id="cb21-416"><a href="#cb21-416" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb21-417"><a href="#cb21-417" aria-hidden="true" tabindex="-1"></a>                       <span class="at">option =</span> <span class="st">"mako"</span>) <span class="sc">+</span></span>
<span id="cb21-418"><a href="#cb21-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span></span>
<span id="cb21-419"><a href="#cb21-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mother's Education"</span>, </span>
<span id="cb21-420"><a href="#cb21-420" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"GPA Score"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb21-421"><a href="#cb21-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb21-422"><a href="#cb21-422" aria-hidden="true" tabindex="-1"></a>all_plot_tail <span class="ot">&lt;-</span> p_fa_tail <span class="sc">+</span> p_mo_tail <span class="sc">+</span> </span>
<span id="cb21-423"><a href="#cb21-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(</span>
<span id="cb21-424"><a href="#cb21-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Student Probability Distribution of GPA by Parental Education"</span>,</span>
<span id="cb21-425"><a href="#cb21-425" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Comparison of GPA distribution shifts, highlighting the narrower variance and stronger core concentration in mother's education groups"</span>,</span>
<span id="cb21-426"><a href="#cb21-426" aria-hidden="true" tabindex="-1"></a>    <span class="at">theme =</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb21-427"><a href="#cb21-427" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-428"><a href="#cb21-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-429"><a href="#cb21-429" aria-hidden="true" tabindex="-1"></a>all_plot_tail</span>
<span id="cb21-430"><a href="#cb21-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-431"><a href="#cb21-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-432"><a href="#cb21-432" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>::: {.callout-note icon="false"}</span>
<span id="cb21-433"><a href="#cb21-433" aria-hidden="true" tabindex="-1"></a>    ## 😺 Observations</span>
<span id="cb21-434"><a href="#cb21-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-435"><a href="#cb21-435" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>First, we've just observed from the tunnel plot that the darkest areas of highest student density show a continuous rightward shift as parental education levels increase. This further confirms our assessment that higher parental education levels are more conducive to cultivating top students and also help prevent children from achieving excessively low grades.</span>
<span id="cb21-436"><a href="#cb21-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-437"><a href="#cb21-437" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Comparing the two plots, the darkest core area for mothers appears more compact and sharper than for fathers. Furthermore, the high density near the median suggests that mothers' education levels may play a more significant role in students' GPAs than fathers'.</span>
<span id="cb21-438"><a href="#cb21-438" aria-hidden="true" tabindex="-1"></a>    :::</span>
<span id="cb21-439"><a href="#cb21-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-440"><a href="#cb21-440" aria-hidden="true" tabindex="-1"></a><span class="fu">## Viz4: High GPA students spent more time on study while spent less on social media</span></span>
<span id="cb21-441"><a href="#cb21-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-442"><a href="#cb21-442" aria-hidden="true" tabindex="-1"></a>Here, I use a **ternary plot** to show the proportions of students spending time on three categories of daily activities (studying/social media/going out with friends). I also color-code points according to different GPA categories to reflect the distribution differences among different GPA categories. The implementation process is as follows: First, I convert the grouping intervals of the three time variables into midpoints for easier comparison, based on the official codebook. For example, social media and going out with friends are 0.5/1.5/2.5/3.5/4.5, while study time—less than 2 hours of study time—is 1, and so on, 3/5/7/9. Then, I obtain three new variables, sm_new, fri_new, and st_new, from the defined midpoints. By calculating the total time (total), and dividing the three new variables by total, I obtain their respective proportions, sm_p, fri_p, and st_p. Finally, I convert GPA_Cat into a factor, use **ggtern()** to draw the plot, and color-code it according to GPA category to observe the clustering trend of different GPA groups in the three types of time allocation.</span>
<span id="cb21-443"><a href="#cb21-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-446"><a href="#cb21-446" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-447"><a href="#cb21-447" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-448"><a href="#cb21-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb21-449"><a href="#cb21-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 13</span></span>
<span id="cb21-450"><a href="#cb21-450" aria-hidden="true" tabindex="-1"></a>midp_sm_fri <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>) </span>
<span id="cb21-451"><a href="#cb21-451" aria-hidden="true" tabindex="-1"></a>midp_study  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>)</span>
<span id="cb21-452"><a href="#cb21-452" aria-hidden="true" tabindex="-1"></a>time_tri_mutated <span class="ot">&lt;-</span> final_ggplot <span class="sc">%&gt;%</span></span>
<span id="cb21-453"><a href="#cb21-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-454"><a href="#cb21-454" aria-hidden="true" tabindex="-1"></a>    <span class="co"># turn categorical variable into midpoint value</span></span>
<span id="cb21-455"><a href="#cb21-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_val =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_SocicalMedia)],</span>
<span id="cb21-456"><a href="#cb21-456" aria-hidden="true" tabindex="-1"></a>    <span class="at">fri_val =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_Friends)],</span>
<span id="cb21-457"><a href="#cb21-457" aria-hidden="true" tabindex="-1"></a>    <span class="at">st_val  =</span> midp_study[<span class="fu">as.integer</span>(Time_Studying)],</span>
<span id="cb21-458"><a href="#cb21-458" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL =</span> sm_val <span class="sc">+</span> fri_val <span class="sc">+</span> st_val</span>
<span id="cb21-459"><a href="#cb21-459" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-460"><a href="#cb21-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TOTAL <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb21-461"><a href="#cb21-461" aria-hidden="true" tabindex="-1"></a><span class="co">#plot </span></span>
<span id="cb21-462"><a href="#cb21-462" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtern</span>(<span class="at">data =</span> time_tri_mutated, <span class="fu">aes</span>(<span class="at">x =</span> st_val, <span class="at">y =</span> sm_val, <span class="at">z =</span> fri_val, <span class="at">colour =</span> GPA_Label)) <span class="sc">+</span></span>
<span id="cb21-463"><a href="#cb21-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-464"><a href="#cb21-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-465"><a href="#cb21-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"High GPA students spent more time on study while spent less on social media"</span>,</span>
<span id="cb21-466"><a href="#cb21-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Ternary plot shows the trade-off between Study, Social Media, and Friends"</span>,</span>
<span id="cb21-467"><a href="#cb21-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">colour =</span> <span class="st">"GPA Category"</span></span>
<span id="cb21-468"><a href="#cb21-468" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb21-469"><a href="#cb21-469" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_rgbw</span>()</span>
<span id="cb21-470"><a href="#cb21-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-471"><a href="#cb21-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-472"><a href="#cb21-472" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>::: {.callout-note icon="false"}</span>
<span id="cb21-473"><a href="#cb21-473" aria-hidden="true" tabindex="-1"></a>    ## 😺 Observations</span>
<span id="cb21-474"><a href="#cb21-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-475"><a href="#cb21-475" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>As can be seen from the distribution of the data points, most points are clearly clustered near the Social Media area, while there is almost no clustering near the Study and Outings locations. This indicates that most students in the sample spend their time on social media, with relatively less time allocated to studying and outings.</span>
<span id="cb21-476"><a href="#cb21-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-477"><a href="#cb21-477" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>At the GPA category level, the distribution of points within each subcategory has a high degree of overlap, and the hypothetical scenario of "high GPA being significantly closer to the learning peak" does not occur. Here we can conclude that judging by the proportion of time spent near the midpoint of the interval, the differences in GPA between groups may be weak. Further statistical tests are needed to confirm this (testing each of the three variables against the GPA Category will yield a more rigorous conclusion).</span>
<span id="cb21-478"><a href="#cb21-478" aria-hidden="true" tabindex="-1"></a>    :::</span>
<span id="cb21-479"><a href="#cb21-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-480"><a href="#cb21-480" aria-hidden="true" tabindex="-1"></a><span class="fu">### Viz5: Does high GPA students spent less time on social media and more on study?</span></span>
<span id="cb21-481"><a href="#cb21-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-482"><a href="#cb21-482" aria-hidden="true" tabindex="-1"></a>First, I use **ggbetweenstats()** to test and display the differences between the three time variables and GPA groups. Since the upper limits of the scales for the three time variables are inconsistent (the highest for study time is "≥8 hours", while the highest for others is "\&gt;4 hours"), to ensure comparability, I converted each category to an **interval midpoint** according to the official codebook, thus unifying the unit of measurement to "hours". After mapping the midpoints, I then generated three numerical variables—Study_hours, Media_hours, and Friends_hours—based on the selected fields, and performed tests with GPA_Cat as the grouping variable (x) and time as y.</span>
<span id="cb21-483"><a href="#cb21-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-484"><a href="#cb21-484" aria-hidden="true" tabindex="-1"></a>For statistical testing, considering that the distribution of the time variables may be non-normal and that the sample sizes between groups are unbalanced, I still used the **Kruskal-Wallis nonparametric test** to attempt to test the differences in time allocation among different GPA groups.</span>
<span id="cb21-485"><a href="#cb21-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-488"><a href="#cb21-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-489"><a href="#cb21-489" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-490"><a href="#cb21-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb21-491"><a href="#cb21-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb21-492"><a href="#cb21-492" aria-hidden="true" tabindex="-1"></a><span class="co"># use mutate</span></span>
<span id="cb21-493"><a href="#cb21-493" aria-hidden="true" tabindex="-1"></a>df_time_analysis <span class="ot">&lt;-</span> final_ggplot <span class="sc">%&gt;%</span></span>
<span id="cb21-494"><a href="#cb21-494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-495"><a href="#cb21-495" aria-hidden="true" tabindex="-1"></a>    <span class="at">st_hours  =</span> midp_study[<span class="fu">as.integer</span>(Time_Studying)],</span>
<span id="cb21-496"><a href="#cb21-496" aria-hidden="true" tabindex="-1"></a>    <span class="at">sm_hours  =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_SocicalMedia)],</span>
<span id="cb21-497"><a href="#cb21-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">fri_hours =</span> midp_sm_fri[<span class="fu">as.integer</span>(Time_Friends)],</span>
<span id="cb21-498"><a href="#cb21-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">TOTAL     =</span> st_hours <span class="sc">+</span> sm_hours <span class="sc">+</span> fri_hours</span>
<span id="cb21-499"><a href="#cb21-499" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-500"><a href="#cb21-500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(TOTAL <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb21-501"><a href="#cb21-501" aria-hidden="true" tabindex="-1"></a><span class="co"># use ggbetweenstats </span></span>
<span id="cb21-502"><a href="#cb21-502" aria-hidden="true" tabindex="-1"></a>viz_study <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb21-503"><a href="#cb21-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_time_analysis,</span>
<span id="cb21-504"><a href="#cb21-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> GPA_Label,</span>
<span id="cb21-505"><a href="#cb21-505" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> st_hours,</span>
<span id="cb21-506"><a href="#cb21-506" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>, <span class="co">#non-parametric</span></span>
<span id="cb21-507"><a href="#cb21-507" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb21-508"><a href="#cb21-508" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb21-509"><a href="#cb21-509" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Study hours across GPA categories"</span>,</span>
<span id="cb21-510"><a href="#cb21-510" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"GPA Category"</span>, </span>
<span id="cb21-511"><a href="#cb21-511" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Study Time (hours)"</span></span>
<span id="cb21-512"><a href="#cb21-512" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-513"><a href="#cb21-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-514"><a href="#cb21-514" aria-hidden="true" tabindex="-1"></a>viz_media <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb21-515"><a href="#cb21-515" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_time_analysis,</span>
<span id="cb21-516"><a href="#cb21-516" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> GPA_Label,</span>
<span id="cb21-517"><a href="#cb21-517" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> sm_hours,</span>
<span id="cb21-518"><a href="#cb21-518" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>,</span>
<span id="cb21-519"><a href="#cb21-519" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb21-520"><a href="#cb21-520" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb21-521"><a href="#cb21-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Social media time across GPA categories"</span>,</span>
<span id="cb21-522"><a href="#cb21-522" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"GPA Category"</span>, </span>
<span id="cb21-523"><a href="#cb21-523" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Social Media Time (hours)"</span></span>
<span id="cb21-524"><a href="#cb21-524" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-525"><a href="#cb21-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-526"><a href="#cb21-526" aria-hidden="true" tabindex="-1"></a>viz_friends <span class="ot">&lt;-</span> <span class="fu">ggbetweenstats</span>(</span>
<span id="cb21-527"><a href="#cb21-527" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_time_analysis,</span>
<span id="cb21-528"><a href="#cb21-528" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> GPA_Label,</span>
<span id="cb21-529"><a href="#cb21-529" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> fri_hours,</span>
<span id="cb21-530"><a href="#cb21-530" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"np"</span>,</span>
<span id="cb21-531"><a href="#cb21-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">messages =</span> <span class="cn">FALSE</span></span>
<span id="cb21-532"><a href="#cb21-532" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb21-533"><a href="#cb21-533" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Time spent with friends across GPA categories"</span>,</span>
<span id="cb21-534"><a href="#cb21-534" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"GPA Category"</span>, </span>
<span id="cb21-535"><a href="#cb21-535" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Friends Time (hours)"</span></span>
<span id="cb21-536"><a href="#cb21-536" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-537"><a href="#cb21-537" aria-hidden="true" tabindex="-1"></a><span class="co">#patchwork</span></span>
<span id="cb21-538"><a href="#cb21-538" aria-hidden="true" tabindex="-1"></a>(viz_study) <span class="sc">/</span> (viz_media <span class="sc">|</span> viz_friends)</span>
<span id="cb21-539"><a href="#cb21-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-540"><a href="#cb21-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-541"><a href="#cb21-541" aria-hidden="true" tabindex="-1"></a>::: {.callout-note icon="false"}</span>
<span id="cb21-542"><a href="#cb21-542" aria-hidden="true" tabindex="-1"></a><span class="fu">## 😺 Observations</span></span>
<span id="cb21-543"><a href="#cb21-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-544"><a href="#cb21-544" aria-hidden="true" tabindex="-1"></a>To compare students’ time-use distributions across GPA groups, we applied the Kruskal–Wallis (non-parametric) test. All three time variables were statistically significant across GPA categories. • Study time: Median study time was 9 hours for every GPA group, mainly because many students fall into the ≥8 hours band. The clearest difference is that the lower-GPA group has a higher share of students with shorter study time. • Social media time: The lower-GPA group shows a higher median social media time, suggesting they spend more time on social media.</span>
<span id="cb21-545"><a href="#cb21-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-546"><a href="#cb21-546" aria-hidden="true" tabindex="-1"></a>• Friends time: Median differences are small; significance indicates only a weak relationship with GPA. Overall, effect sizes are small, meaning differences are modest and driven more by distributional shifts than large between-group gaps.</span>
<span id="cb21-547"><a href="#cb21-547" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-548"><a href="#cb21-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-549"><a href="#cb21-549" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6 Student Perceptions and Learning Environment</span></span>
<span id="cb21-550"><a href="#cb21-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-551"><a href="#cb21-551" aria-hidden="true" tabindex="-1"></a>In section 5, we explored the relationship and differences between behavior and GPA. Now, let's move on to the next section on perception. After completing the previous section, I couldn't help but wonder: besides behavior, are there also systemic differences between perceptual experience and GPA? Which perceptual dimensions are most relevant?</span>
<span id="cb21-552"><a href="#cb21-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-553"><a href="#cb21-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### Viz6: Students are most satisfied with school but personal habits still decides at certain cases</span></span>
<span id="cb21-554"><a href="#cb21-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-555"><a href="#cb21-555" aria-hidden="true" tabindex="-1"></a>This figure uses **HH** to plot, illustrating the frequency distribution of students' responses to eight learning perception items on a 1–5 Likert scale. First, the eight variables (table b) were extracted from final_ggplot, and then convert the wide table to a long table, resulting in two columns: Measure and Response. I then created a contingency table for these two columns, converting each row to a percentage. This was done to eliminate the impact of sample size differences on the graph's scale. Finally, I used the HH::**likert()** function to plot the Diverging Stacked Bar, using percentages as a uniform measure to directly show the differences and frequency distribution of each variable.</span>
<span id="cb21-556"><a href="#cb21-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-559"><a href="#cb21-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-560"><a href="#cb21-560" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-561"><a href="#cb21-561" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb21-562"><a href="#cb21-562" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb21-563"><a href="#cb21-563" aria-hidden="true" tabindex="-1"></a>survey_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Study_Methods"</span>, <span class="st">"SupportOf_Uni"</span>, <span class="st">"SupportOf_Lec"</span>, <span class="st">"Facilitie_Uni"</span>, </span>
<span id="cb21-564"><a href="#cb21-564" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Quality_Lecturer"</span>, <span class="st">"TrainingCurriculum"</span>, <span class="st">"Competitive_Class"</span>, <span class="st">"InfuenceF_Friends"</span>)</span>
<span id="cb21-565"><a href="#cb21-565" aria-hidden="true" tabindex="-1"></a><span class="co">#prepare long table</span></span>
<span id="cb21-566"><a href="#cb21-566" aria-hidden="true" tabindex="-1"></a>survey_long <span class="ot">&lt;-</span> final_ggplot[, survey_vars] <span class="sc">%&gt;%</span></span>
<span id="cb21-567"><a href="#cb21-567" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(measure, response)</span>
<span id="cb21-568"><a href="#cb21-568" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting to factor</span></span>
<span id="cb21-569"><a href="#cb21-569" aria-hidden="true" tabindex="-1"></a>survey_long<span class="sc">$</span>measure <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(survey_long<span class="sc">$</span>measure)</span>
<span id="cb21-570"><a href="#cb21-570" aria-hidden="true" tabindex="-1"></a>survey_long<span class="sc">$</span>response <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(survey_long<span class="sc">$</span>response)</span>
<span id="cb21-571"><a href="#cb21-571" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating the contingency table</span></span>
<span id="cb21-572"><a href="#cb21-572" aria-hidden="true" tabindex="-1"></a>survey_df <span class="ot">&lt;-</span> <span class="fu">table</span>(survey_long<span class="sc">$</span>measure, survey_long<span class="sc">$</span>response) <span class="sc">%&gt;%</span></span>
<span id="cb21-573"><a href="#cb21-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame.matrix</span>()</span>
<span id="cb21-574"><a href="#cb21-574" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the column name</span></span>
<span id="cb21-575"><a href="#cb21-575" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(survey_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Not at all"</span>, <span class="st">"Little"</span>, <span class="st">"Moderate"</span>, <span class="st">"Quite"</span>, <span class="st">"Very"</span>)</span>
<span id="cb21-576"><a href="#cb21-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-577"><a href="#cb21-577" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(survey_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Class Competition"</span>, <span class="st">"University Facilities"</span>, <span class="st">"Peer Influence"</span>, </span>
<span id="cb21-578"><a href="#cb21-578" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Lecturer Support"</span>, <span class="st">"Lecturer Quality"</span>, <span class="st">"Study Methods"</span>, </span>
<span id="cb21-579"><a href="#cb21-579" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"University Support"</span>, <span class="st">"Training Curriculum"</span>)</span>
<span id="cb21-580"><a href="#cb21-580" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the dataframe row name</span></span>
<span id="cb21-581"><a href="#cb21-581" aria-hidden="true" tabindex="-1"></a>survey_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(survey_df, <span class="at">var =</span> <span class="st">"Measure"</span>)</span>
<span id="cb21-582"><a href="#cb21-582" aria-hidden="true" tabindex="-1"></a><span class="co"># plot using HH package</span></span>
<span id="cb21-583"><a href="#cb21-583" aria-hidden="true" tabindex="-1"></a><span class="fu">likert</span>(Measure <span class="sc">~</span> ., </span>
<span id="cb21-584"><a href="#cb21-584" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> survey_df, </span>
<span id="cb21-585"><a href="#cb21-585" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-586"><a href="#cb21-586" aria-hidden="true" tabindex="-1"></a>       <span class="at">ReferenceZero =</span> <span class="dv">3</span>, </span>
<span id="cb21-587"><a href="#cb21-587" aria-hidden="true" tabindex="-1"></a>       <span class="at">as.percent =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-588"><a href="#cb21-588" aria-hidden="true" tabindex="-1"></a>       <span class="at">positive.order =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-589"><a href="#cb21-589" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">list</span>(<span class="st">" Most of Students are generally satisfied with Learning Perceptions"</span>, <span class="at">x =</span> <span class="fu">unit</span>(.<span class="dv">55</span>, <span class="st">"npc"</span>)), </span>
<span id="cb21-590"><a href="#cb21-590" aria-hidden="true" tabindex="-1"></a>       <span class="at">sub =</span> <span class="fu">list</span>(<span class="st">"Satisfaction Rating (1-5 Scale)"</span>, <span class="at">x =</span> <span class="fu">unit</span>(.<span class="dv">57</span>, <span class="st">"npc"</span>)),</span>
<span id="cb21-591"><a href="#cb21-591" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="sc">-</span><span class="dv">80</span>, <span class="sc">-</span><span class="dv">60</span>, <span class="sc">-</span><span class="dv">40</span>, <span class="sc">-</span><span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</span>
<span id="cb21-592"><a href="#cb21-592" aria-hidden="true" tabindex="-1"></a>       <span class="at">strip =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-593"><a href="#cb21-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-594"><a href="#cb21-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-595"><a href="#cb21-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-596"><a href="#cb21-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>::: panel-tabset</span>
<span id="cb21-597"><a href="#cb21-597" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>::: {.callout-note icon="false"}</span>
<span id="cb21-598"><a href="#cb21-598" aria-hidden="true" tabindex="-1"></a>        ## 😺 Observations</span>
<span id="cb21-599"><a href="#cb21-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-600"><a href="#cb21-600" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Overall, the eight variables related to learning perceptions are significantly biased towards the positive: "very" generally accounts for a larger proportion than "not at all," indicating respondents have a positive evaluation of the school's environment and support. The proportion of "very" is large for teaching-related dimensions, indicating respondents are satisfied with these variables. Conversely, proportions of "Moderate" and "little" are relatively high for "Study_Methods" and "influence from friends," indicating these factors are more likely related to personal habits.</span>
<span id="cb21-601"><a href="#cb21-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-602"><a href="#cb21-602" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>This leads to a conclusion that respondents are generally satisfied with learning perceptions, but some factors still depend on individual differences. Besides, it also provides an overview for subsequent analysis of the relationship between perception variables and GPA.</span>
<span id="cb21-603"><a href="#cb21-603" aria-hidden="true" tabindex="-1"></a>        :::</span>
<span id="cb21-604"><a href="#cb21-604" aria-hidden="true" tabindex="-1"></a>    :::</span>
<span id="cb21-605"><a href="#cb21-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-606"><a href="#cb21-606" aria-hidden="true" tabindex="-1"></a><span class="fu">### Viz7: Does GPA have the relationship with perception variables?</span></span>
<span id="cb21-607"><a href="#cb21-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-608"><a href="#cb21-608" aria-hidden="true" tabindex="-1"></a>First, I selected all perceptual variables and GPA (num). Since Likert categorizes variables by class, I converted all variables into ordered numerical representations by **as.numeric** function. Then, I used **cor(method="spearman")** to generate the Spearman correlation matrix. Finally, I used the basic function **heatmap()** to visualize the correlation matrix, preserving the hierarchical clustering dendrogram to observe the similarity and clustering structure between variables.</span>
<span id="cb21-609"><a href="#cb21-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-612"><a href="#cb21-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-613"><a href="#cb21-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb21-614"><a href="#cb21-614" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb21-615"><a href="#cb21-615" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 10</span></span>
<span id="cb21-616"><a href="#cb21-616" aria-hidden="true" tabindex="-1"></a><span class="co"># selecting vars</span></span>
<span id="cb21-617"><a href="#cb21-617" aria-hidden="true" tabindex="-1"></a>var_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GPA_Num"</span>, <span class="st">"Adapt_Learning_Uni"</span>, <span class="st">"Study_Methods"</span>, <span class="st">"SupportOf_Uni"</span>, </span>
<span id="cb21-618"><a href="#cb21-618" aria-hidden="true" tabindex="-1"></a>              <span class="st">"SupportOf_Lec"</span>, <span class="st">"Facilitie_Uni"</span>, <span class="st">"Quality_Lecturer"</span>, </span>
<span id="cb21-619"><a href="#cb21-619" aria-hidden="true" tabindex="-1"></a>              <span class="st">"TrainingCurriculum"</span>, <span class="st">"Competitive_Class"</span>, <span class="st">"InfuenceF_Friends"</span>)</span>
<span id="cb21-620"><a href="#cb21-620" aria-hidden="true" tabindex="-1"></a>correl_var <span class="ot">&lt;-</span> final_ggplot[, var_list]</span>
<span id="cb21-621"><a href="#cb21-621" aria-hidden="true" tabindex="-1"></a><span class="co"># turn into numerical as.numeric</span></span>
<span id="cb21-622"><a href="#cb21-622" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>GPA_Num           <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>GPA_Num))</span>
<span id="cb21-623"><a href="#cb21-623" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Adapt_Learning_Uni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Adapt_Learning_Uni))</span>
<span id="cb21-624"><a href="#cb21-624" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Study_Methods     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Study_Methods))</span>
<span id="cb21-625"><a href="#cb21-625" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>SupportOf_Uni     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>SupportOf_Uni))</span>
<span id="cb21-626"><a href="#cb21-626" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>SupportOf_Lec     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>SupportOf_Lec))</span>
<span id="cb21-627"><a href="#cb21-627" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Facilitie_Uni     <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Facilitie_Uni))</span>
<span id="cb21-628"><a href="#cb21-628" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Quality_Lecturer  <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Quality_Lecturer))</span>
<span id="cb21-629"><a href="#cb21-629" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>TrainingCurriculum <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>TrainingCurriculum))</span>
<span id="cb21-630"><a href="#cb21-630" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>Competitive_Class <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>Competitive_Class))</span>
<span id="cb21-631"><a href="#cb21-631" aria-hidden="true" tabindex="-1"></a>correl_var<span class="sc">$</span>InfuenceF_Friends <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.factor</span>(correl_var<span class="sc">$</span>InfuenceF_Friends))</span>
<span id="cb21-632"><a href="#cb21-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-633"><a href="#cb21-633" aria-hidden="true" tabindex="-1"></a><span class="co"># spearman matrix</span></span>
<span id="cb21-634"><a href="#cb21-634" aria-hidden="true" tabindex="-1"></a>wh_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(correl_var, <span class="at">method =</span> <span class="st">"spearman"</span>)</span>
<span id="cb21-635"><a href="#cb21-635" aria-hidden="true" tabindex="-1"></a>wh_matrix[<span class="fu">is.na</span>(wh_matrix)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-636"><a href="#cb21-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-637"><a href="#cb21-637" aria-hidden="true" tabindex="-1"></a><span class="co"># plot heatmap</span></span>
<span id="cb21-638"><a href="#cb21-638" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb21-639"><a href="#cb21-639" aria-hidden="true" tabindex="-1"></a>  wh_matrix,</span>
<span id="cb21-640"><a href="#cb21-640" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rowv =</span> <span class="cn">NA</span>, <span class="at">Colv =</span> <span class="cn">NA</span>,         </span>
<span id="cb21-641"><a href="#cb21-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="st">"none"</span>, </span>
<span id="cb21-642"><a href="#cb21-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">cexRow =</span> <span class="fl">0.9</span>, <span class="at">cexCol =</span> <span class="fl">0.9</span>,</span>
<span id="cb21-643"><a href="#cb21-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">10</span>),</span>
<span id="cb21-644"><a href="#cb21-644" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Does GPA have the relationship with perception variables?"</span></span>
<span id="cb21-645"><a href="#cb21-645" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-646"><a href="#cb21-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-647"><a href="#cb21-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-648"><a href="#cb21-648" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>::: {.callout-note icon="false"}</span>
<span id="cb21-649"><a href="#cb21-649" aria-hidden="true" tabindex="-1"></a>    ## 😺 Observations</span>
<span id="cb21-650"><a href="#cb21-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-651"><a href="#cb21-651" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We can easily observe significant positive correlations among the nine learning perception variables (darker areas), indicating that these perception dimensions are interdependent and related. For example, "school support/teacher support/curriculum and facilities" tend to cluster together, suggesting a high degree of consistency in students' overall evaluations of the learning environment and teachers.</span>
<span id="cb21-652"><a href="#cb21-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-653"><a href="#cb21-653" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Notably, the GPA_Num row/column is very light in color, indicating almost no correlation between GPA and the learning perception variables. The overall trend is that the perception variables have a strong synergistic effect, while GPA has virtually no relationship with any single perception variable.</span>
<span id="cb21-654"><a href="#cb21-654" aria-hidden="true" tabindex="-1"></a>    :::</span>
<span id="cb21-655"><a href="#cb21-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-656"><a href="#cb21-656" aria-hidden="true" tabindex="-1"></a><span class="fu"># 7. Summary</span></span>
<span id="cb21-657"><a href="#cb21-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-658"><a href="#cb21-658" aria-hidden="true" tabindex="-1"></a>This paper's exploratory data visualization analysis goes beyond simply representing the data; it transforms tabular data into actionable behavioral insights. While the original statistical tests (e.g., Tables 4 and 7 on the research paper <span class="ot">&lt;https://www.sciencedirect.com/science/article/pii/S2352340925001702&gt;</span>) confirm basic correlations, our visualization model further reveals the potential dynamics of how these variables interact in students' daily lives.</span>
<span id="cb21-659"><a href="#cb21-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-660"><a href="#cb21-660" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-661"><a href="#cb21-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-662"><a href="#cb21-662" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-663"><a href="#cb21-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-664"><a href="#cb21-664" aria-hidden="true" tabindex="-1"></a>    ## 7.1 Key Findings:</span>
<span id="cb21-665"><a href="#cb21-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-666"><a href="#cb21-666" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Table 3 shows that most students' GPAs hover around 3.0 ("Good" to "Excellent"), while the ridgeline plot visualizes a phenomenon: as students approach graduation, the distribution of high-achieving students becomes significantly more concentrated, suggesting a unique adaptation curve that the original mean cannot capture.</span>
<span id="cb21-667"><a href="#cb21-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-668"><a href="#cb21-668" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Table 4 shows that both parents' educational backgrounds are significantly correlated with GPA. Similarly, the funnel density plot reveals a deeper, clearer, and more concentrated impact of maternal education on students' academic performance, preventing extremely low scores.</span>
<span id="cb21-669"><a href="#cb21-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-670"><a href="#cb21-670" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Table 1 shows that over 82% of students study for more than 8 hours a day. Conversely, our ternary plot and KW test box plot reveal a key paradox: the length of study time does not guarantee a high GPA. The real difference lies in social media. It can be seen that the median time spent on social media is significantly higher among those with lower GPAs, reducing their substantial study time.</span>
<span id="cb21-671"><a href="#cb21-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-672"><a href="#cb21-672" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Table 2 highlights the generally positive student satisfaction with university facilities and lecturer quality. However, based on Likert distribution and correlation heatmaps (inspired by the weak Pearson correlation in Table 5), GPA is not correlated with students' positive evaluations of campus facilities/faculty; instead, individual study methods and adaptability deserve attention.</span>
<span id="cb21-673"><a href="#cb21-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-674"><a href="#cb21-674" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-675"><a href="#cb21-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-676"><a href="#cb21-676" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-677"><a href="#cb21-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-678"><a href="#cb21-678" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-679"><a href="#cb21-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-680"><a href="#cb21-680" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="dt">&lt;</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-681"><a href="#cb21-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-682"><a href="#cb21-682" aria-hidden="true" tabindex="-1"></a>    ## 7.2 Recommendations:</span>
<span id="cb21-683"><a href="#cb21-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-684"><a href="#cb21-684" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Students' average study time exceeds 8 hours, so the time aspect is not the problem; the more important issue is the quality. Future surveys could focus on questions such as how many hours of focused study time are taken (without interruptions).</span>
<span id="cb21-685"><a href="#cb21-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-686"><a href="#cb21-686" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Living in the digital age, we must acknowledge that social media occupies a significant portion of students' time. Therefore, schools should take action to restrict some social media use (e.g., prohibiting mobile phones on campus), which could significantly improve students' average GPA.</span>
<span id="cb21-687"><a href="#cb21-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-688"><a href="#cb21-688" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In addition to the school's own advantages (teachers, facilities), universities should pay more attention to the learning methods and adaptation of students with low GPAs or lower-year students, provide more psychological counseling and outreach activities, and improve students' satisfaction with other perceived factors.</span>
<span id="cb21-689"><a href="#cb21-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-690"><a href="#cb21-690" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-691"><a href="#cb21-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-692"><a href="#cb21-692" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb21-693"><a href="#cb21-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-694"><a href="#cb21-694" aria-hidden="true" tabindex="-1"></a><span class="fu"># 8.References</span></span>
<span id="cb21-695"><a href="#cb21-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-696"><a href="#cb21-696" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prof Kam, Tin Seong. (2026). Visualising Distribution. *R for Visual Analytics.*<span class="ot">&lt;https://r4va.netlify.app/chap08&gt;</span></span>
<span id="cb21-697"><a href="#cb21-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-698"><a href="#cb21-698" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tran, Vinh Doan, Nguyen, Kim Son Thi, &amp; Le, Diep Ngoc. (2025). Dataset of factors affecting learning outcomes of students at the University of Education, Vietnam National University, Hanoi. <span class="ot">&lt;https://www.sciencedirect.com/science/article/pii/S2352340925001702&gt;</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>